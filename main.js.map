{"version":3,"sources":["webpack:///webpack/bootstrap 45e2afb74ac9f95458c2","webpack:///./src/index.js","webpack:///./src/drawer/index.js","webpack:///./src/main/index.js","webpack:///./src/simulator/index.js","webpack:///./src/neuro_net/network.js","webpack:///./src/neuro_net/layer.js","webpack:///./src/neuro_net/neuron.js","webpack:///./src/neuro_net/ready_functions.js","webpack:///./src/neuro_net/activate_functions.js","webpack:///./src/math/vec2.js","webpack:///./src/evolve/index.js","webpack:///./src/ui_controller.js"],"names":["window","PARTS_NUM","UNIT_RAD","FOOD_RAD","LINE_LENGTH","drawer","document","getElementById","MainController","ui","CanvasDrawer","canvas","params","width","height","ctx","getContext","source","end","color","strokeStyle","beginPath","moveTo","x","y","lineTo","stroke","frameData","clear","fillStyle","units","map","drawUnit","food","drawFoodItem","unit","score","lines","radius","font","textAlign","textBaseline","fillText","arc","Math","PI","drawCanvasLine","line","from","to","active","item","fill","clearRect","opts","setCallback","actionHandler","simulator","generateFood","options","visibleUnit","populationSize","speed","evolver","numberOfGenes","numberOfWinners","genesToMutate","mutationRate","current","status","populationNum","init","type","value","Object","assign","draw","update","u","visible","highlight","getViewebleUnitIndex","start","pause","Array","round","random","data","row","matrix","i","length","push","slice","population","weights","toMatrix","initRandomPopulation","initRound","toUnits","evolve","drawFrame","filter","life","sort","a","b","indexOf","t","clearInterval","interval","setInterval","step","err","console","log","NETWORK_PARAMS","layers","activateFunction","Simulator","rooms","foods","mind","key","main_vector","sub","point","circlePoint","project","_vec","add","vec_length","begintInter","endInter","isInterruct","DotProduct","interSect","projectedPoint","ort","multScalar","l","sqrt","p1","p2","filtered","p","_a","Sub","_b","endPoints","concat","findCollisions","min","res","full","part","curDeg","vec","cos","sin","processLine","movement","coords","max","diff","abs","_key","splice","room","getUnitLines","signals","getUnitSignals","process","movedUnit","moveUnit","checkEat","Network","defaultParams","input","_in","ACTIVATE_FUNCTIONS","Layer","neurons","n","domain","defaultOut","out","neuron","Neuron","activationFunc","GetActivationFunc","sum","weight","Number","isFinite","Error","func","functions","keys","bind","s","A","exp","Vec2","set","result","arguments","name","vec2","Add","Multiply","scalar","size","w","h","Project","Angle","obj","vec1","pow","d","dotProduct","dp","multiplier","Evolver","DEFAULT_CONFIG","genes","gen","genome1","genome2","genomes","child","marks","marked","mark","parents","counter","_l","parent1","parent2","cross","prepopulation","at","genome","mutate","crossing","select","UIController","callback","putButtons","putPlayPause","putPopulationNum","node","style","cont","querySelector","pop","o","c","children","btn","graph","fontWeight","backgroundColor","innerHTML","selected","border","fontSize","lineHeight","cursor","selStyle","createElement","id","setStyle","display","marginLeft","el","innerText","onclick","appendChild","num","body","arr","margin","inf"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 45e2afb74ac9f95458c2","import CanvasDrawer from './drawer';\nimport MainController from './main';\nimport UIController from './ui_controller';\n\nwindow.PARTS_NUM = 15;\nwindow.UNIT_RAD = 30;\nwindow.FOOD_RAD = 8;\nwindow.LINE_LENGTH = 25;\n\nwindow.drawer = new CanvasDrawer(document.getElementById('canvas'));;\nwindow.MainController = new MainController({ drawer, ui: UIController });\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","export default class CanvasDrawer {\n\n\tconstructor(canvas) {\n\n\t\tthis.params = {\n\t\t\twidth: canvas.width,\n\t\t\theight: canvas.height,\n\t\t}\n\n\t\tthis.ctx = canvas.getContext('2d');\n\n\t}\n\n\t// drawSmallPoint(coords, radius, color) {\n\t//\n\t// \tthis.ctx.fillStyle = color;\n\t// \tthis.ctx.beginPath();\n\t// \tthis.ctx.arc(coords.x, coords.y, radius, 0, Math.PI * 2, false);\n\t// \tthis.ctx.fill();\n\t//\n\t// }\n\n\tdrawCanvasLine(source, end, color) {\n\n\t\tthis.ctx.strokeStyle = color;\n\t\tthis.ctx.beginPath();\n\t\tthis.ctx.moveTo(source.x,source.y);\n\t\tthis.ctx.lineTo(end.x,end.y);\n\t\tthis.ctx.stroke();\n\n\t}\n\n\tdrawFrame(frameData) {\n\n\t\tthis.clear();\n\n\t\tthis.ctx.strokeStyle = '#40484f';\n\t\tthis.ctx.fillStyle = '#0abe55';\n\n\t\tframeData\n\t\t\t.units\n\t\t\t.map(::this.drawUnit);\n\n\t\tframeData\n\t\t\t.food\n\t\t\t.map(::this.drawFoodItem);\n\n\n\t}\n\n\tdrawUnit(unit) {\n\n\t\tconst { x, y, score, lines } = unit;\n\n\t\tthis.ctx.beginPath();\n\t\tconst radius = UNIT_RAD;\n\n\t\tthis.ctx.font = \"24px Arial\";\n\t\tthis.ctx.textAlign = \"center\";\n\t\tthis.ctx.textBaseline = \"middle\";\n\t\tthis.ctx.strokeStyle = 'black';\n\t\tthis.ctx.fillText(score, unit.x, unit.y);\n\t\tthis.ctx.arc(x, y, radius, 0, Math.PI * 2, false);\n\t\tthis.ctx.stroke();\n\n\t\tlines.map(line =>\n\t\t\tthis.drawCanvasLine(line.from, line.to, line.active ? 'green' : 'black'));\n\n\t}\n\n\tdrawFoodItem(item) {\n\n\t\tconst { x, y } = item;\n\n\t\tthis.ctx.beginPath();\n\t\tconst radius = FOOD_RAD;\n\n\t\tthis.ctx.arc(x, y, radius, 0, Math.PI * 2, false);\n\t\tthis.ctx.fill();\n\n\t}\n\n\tclear() {\n\n\t\tthis.ctx.clearRect(0, 0, this.params.width, this.params.height);\n\n\t}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/drawer/index.js","import World from '../simulator';\nimport Vec2 from '../math/vec2';\nimport Evolver from '../evolve';\n\nexport default class MainController {\n\n\tconstructor(opts) {\n\n\t\tthis.drawer = opts.drawer;\n\t\tthis.ui = opts.ui;\n\t\tthis.ui.setCallback(::this.actionHandler);\n\n\t\tthis.simulator = new World();\n\t\tthis.generateFood();\n\n\t\tthis.options = {\n\t\t\tvisibleUnit: 'HS',\n\t\t\tpopulationSize: 10,\n\t\t\tspeed: 0,\n\t\t}\n\n\t\tthis.evolver = new Evolver({\n\t\t\tpopulationSize: this.options.populationSize,\n\t\t\tnumberOfGenes: 450,\n\t\t\tnumberOfWinners: 3,\n\t\t\tgenesToMutate: 200,\n\t\t\tmutationRate: 0.25\n\t\t});\n\n\t\tthis.current = [];\n\t\tthis.status = 'paused';\n\t\tthis.populationNum = 0;\n\n\t\tthis.init();\n\n\t}\n\n\tactionHandler(type, value) {\n\n\t\tswitch (type) {\n\n\t\t\tcase 'options':\n\n\t\t\t\tthis.options = Object.assign(this.options, value);\n\n\t\t\t\tif (typeof value.visibleUnit != 'undefined') {\n\n\t\t\t\t\tthis.draw();\n\t\t\t\t\tthis.ui.update({\n\t\t\t\t\t\tunits: this.current.map(u => u.units[0]),\n\t\t\t\t\t\tvisible: this.options.visibleUnit,\n\t\t\t\t\t\thighlight: this.getViewebleUnitIndex(),\n\t\t\t\t\t\tpopulationNum: this.populationNum\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'play':\n\n\t\t\t\tif (this.status == 'paused') {\n\t\t\t\t\tthis.start();\n\t\t\t\t} else if (this.status == 'started') {\n\t\t\t\t\tthis.pause();\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tgenerateFood() {\n\n\t\tthis.food = new Array(Math.round(Math.random() * 100))\n\t\t\t.fill(null)\n\t\t\t.map(() => {\n\n\t\t\t\treturn new Vec2(\n\t\t\t\t\tMath.random() * 800,\n\t\t\t\t\tMath.random() * 400,\n\t\t\t\t);\n\n\t\t\t});\n\n\t}\n\n\ttoMatrix(data, row) {\n\n\t\tvar matrix = [];\n\t\tfor (var i = 0; i < data.length; i += row) {\n\t\t\tmatrix.push(data.slice(i, i + row));\n\t\t}\n\t\treturn matrix;\n\n\t}\n\n\ttoUnits(population) {\n\n\t\treturn population.map(u => {\n\n\t\t\treturn {\n\t\t\t\tx: 400,\n\t\t\t\ty: 200,\n\t\t\t\tweights: [\n\t\t\t\t\tthis.toMatrix(u.slice(0, u.length / 2), 15),\n\t\t\t\t\tthis.toMatrix(u.slice(u.length / 2, u.length), 15),\n\t\t\t\t]\n\t\t\t};\n\n\t\t});\n\n\t}\n\n\tinit() {\n\n\t\tthis.evolver.initRandomPopulation();\n\t\tthis.ui.init(this);\n\t\tthis.initRound();\n\t}\n\n\tinitRound() {\n\n\t\tconst population = this.toUnits(this.evolver.population);\n\n\t\tthis.simulator.init(population, this.food);\n\t\tthis.start(this.options.speed);\n\n\t}\n\n\tevolve() {\n\n\t\tthis.evolver.evolve(this.current.map(u => u.score));\n\t\tthis.populationNum++;\n\n\t}\n\n\tdraw() {\n\n\t\tthis.drawer.drawFrame(this.current[ this.getViewebleUnitIndex() ]);\n\n\t}\n\n\tgetViewebleUnitIndex() {\n\n\t\tif (this.options.visibleUnit === 'HS') {\n\t\t\tconst i = this.current\n\t\t\t\t.filter(u => u.units[0].life > 0)\n\t\t\t\t.sort((a, b) => {\n\n\t\t\t\t\tif (a.units[0].score > b.units[0].score) {\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\t}\n\t\t\t\t\tif (a.units[0].score < b.units[0].score) {\n\t\t\t\t\t\treturn 1;\n\t\t\t\t\t}\n\t\t\t\t\treturn 0;\n\n\t\t\t\t})[ 0 ];\n\t\t\treturn this.current.indexOf(i);\n\t\t}\n\n\t\treturn this.options.visibleUnit - 1;\n\n\t}\n\n\tstart(t = 10) {\n\n\t\tthis.status = 'started';\n\t\tclearInterval(this.interval);\n\t\tthis.interval = setInterval(() => {\n\t\t\tthis.step();\n\t\t}, t);\n\n\t}\n\n\tpause() {\n\n\t\tthis.status = 'paused';\n\t\tclearInterval(this.interval);\n\n\t}\n\n\tstep() {\n\n\t\ttry {\n\n\t\t\tthis.current = this.simulator.step();\n\t\t\tthis.ui.update({\n\t\t\t\tunits: this.current.map(u => u.units[0]),\n\t\t\t\tvisible: this.options.visibleUnit,\n\t\t\t\thighlight: this.getViewebleUnitIndex(),\n\t\t\t\tpopulationNum: this.populationNum\n\t\t\t});\n\t\t\tif (this.current.map(u => u.end).indexOf(false) === -1) {\n\n\t\t\t\tthis.pause();\n\t\t\t\tthis.evolve();\n\t\t\t\tthis.generateFood();\n\t\t\t\tthis.initRound();\n\n\t\t\t} else {\n\n\t\t\t\tthis.draw();\n\n\t\t\t}\n\n\t\t} catch (err) {\n\n\t\t\tthis.pause();\n\t\t\tconsole.log(err);\n\n\t\t}\n\n\t}\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/main/index.js","import Net from '../neuro_net/network';\nimport Vec2 from '../math/vec2';\n\nconst NETWORK_PARAMS = (weights) => {\n\treturn {\n\t\tlayers: [\n\t\t\t{\n\t\t\t\tweights: weights[ 0 ],\n\t\t\t\tlength: weights[ 0 ].length,\n\t\t\t\tactivateFunction: 'sigmoid'\n\t\t\t},\n\t\t\t{\n\t\t\t\tweights: weights[ 1 ],\n\t\t\t\tlength: weights[ 1 ].length,\n\t\t\t\tactivateFunction: 'sigmoid'\n\t\t\t}\n\t\t]\n\t}\n}\n\nexport default class Simulator {\n\n\tconstructor() {\n\n\t\tthis.rooms = [{\n\t\t\tunits: [],\n\t\t\tfoods: []\n\t\t}];\n\n\t}\n\n\tinit(units, foods) {\n\n\t\tthis.rooms = units.map(u => {\n\t\t\treturn {\n\t\t\t\tunit: {\n\t\t\t\t\t...u,\n\t\t\t\t\tscore: 0,\n\t\t\t\t\tmind: new Net(NETWORK_PARAMS(u.weights)),\n\t\t\t\t\tlife: 100\n\t\t\t\t},\n\t\t\t\tfoods: foods.map(food => food)\n\t\t\t}\n\t\t});\n\n\t}\n\n\tfindCollisions(source, end, key) {\n\n\t\treturn this.rooms[ key ].foods.map(circlePoint => {\n\n\t\t\tconst main_vector = end.sub(source);\n\n\t\t\tconst point = circlePoint.sub(source).project(main_vector);\n\t\t\tconst _vec = point.add(source).sub(circlePoint);\n\n\t\t\tconst radius = FOOD_RAD;\n\t\t\tconst vec_length = _vec.length;\n\t\t\tconst begintInter = source.sub(circlePoint).length < radius;\n\t\t\tconst endInter = end.sub(circlePoint).length < radius;\n\n\t\t\tconst isInterruct = vec_length < radius\n\t\t\t\t&& Vec2.DotProduct(point, main_vector) >= 0\n\t\t\t\t&& main_vector.length >= point.length;\n\t\t\tconst interSect = isInterruct || (begintInter || endInter);\n\n\t\t\tif (interSect) {\n\n\t\t\t\tconst projectedPoint = point.add(source);\n\t\t\t\tconst ort = main_vector.multScalar(1/main_vector.length);\n\t\t\t\tconst l = Math.sqrt(radius*radius - vec_length*vec_length) * 2;\n\n\t\t\t\tconst p1 = projectedPoint.sub(ort.multScalar((l / 2)));\n\t\t\t\tconst p2 = projectedPoint.add(ort.multScalar((l / 2)));\n\n\t\t\t\tconst filtered = [p1, p2].filter(p => {\n\t\t\t\t\treturn ((p.x >= source.x && p.x <= end.x) || (p.x <= source.x && p.x >= end.x))\n\t\t\t\t\t\t&& ((p.y >= source.y && p.y <= end.y) || (p.y <= source.y && p.y >= end.y))\n\t\t\t\t}).sort((a, b) => {\n\n\t\t\t\t\tconst _a = Vec2.Sub(a, source).length;\n\t\t\t\t\tconst _b = Vec2.Sub(b, source).length;\n\n\t\t\t\t\tif (_a > _b) {\n\t\t\t\t\t\treturn 1;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (_a > _b) {\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn 0;\n\n\t\t\t\t})[0];\n\n\t\t\t\tif (filtered) {\n\n\t\t\t\t\treturn filtered;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn false;\n\n\t\t});\n\n\t}\n\n\tprocessLine(start, end, key) {\n\n\t\tconst endPoints = [end].concat(this.findCollisions(start, end, key));\n\t\tlet min = end.sub(start).length;\n\t\tlet res = end;\n\t\tlet active = false;\n\t\tendPoints.map(p => {\n\n\t\t\tif (p) {\n\t\t\t\tconst length = p.sub(start).length;\n\t\t\t\tif (length < min) {\n\t\t\t\t\tactive = true;\n\t\t\t\t\tmin = length;\n\t\t\t\t\tres = p;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn p;\n\n\t\t});\n\t\treturn {\n\t\t\tfrom: start,\n\t\t\tto: res,\n\t\t\tactive\n\t\t};\n\n\t}\n\n\tgetUnitLines(unit, key) {\n\n\t\tconst full = Math.PI * 2;\n\t\tconst part = full / PARTS_NUM;\n\t\tlet curDeg = -part;\n\t\tlet res = [];\n\n\t\tfor (let i = 0; i < PARTS_NUM; i++) {\n\n\t\t\tcurDeg += part;\n\t\t\tconst vec = new Vec2(\n\t\t\t\tMath.cos(curDeg),\n\t\t\t\tMath.sin(curDeg),\n\t\t\t);\n\n\t\t\tres.push(this.processLine(\n\t\t\t\tnew Vec2(unit).add(vec.multScalar(UNIT_RAD)),\n\t\t\t\tnew Vec2(unit).add(vec.multScalar(UNIT_RAD))\n\t\t\t\t\t.add(vec.multScalar(LINE_LENGTH)),\n\t\t\t\tkey\n\t\t\t));\n\n\t\t}\n\n\t\treturn res;\n\n\t}\n\n\tgetUnitSignals(lines) {\n\n\t\treturn lines.map(line =>\n\t\t(\n\t\t\tMath.round(\n\t\t\t\t(LINE_LENGTH - Math.min(line.to.sub(line.from).length, 25)) * 1000\n\t\t\t) / 1000) / LINE_LENGTH\n\t\t);\n\n\t}\n\n\tmoveUnit(movement, key) {\n\n\t\tconst full = Math.PI * 2;\n\t\tconst part = full / PARTS_NUM;\n\t\tlet curDeg = -part;\n\t\tlet x = 0;\n\t\tlet y = 0;\n\n\t\tfor (let i = 0; i < PARTS_NUM; i++) {\n\n\t\t\tcurDeg += part;\n\t\t\tx += movement[ i ] * Math.cos(curDeg) * 2;\n\t\t\ty += movement[ i ] * Math.sin(curDeg) * 2;\n\n\t\t}\n\n\t\tconst coords = new Vec2(\n\t\t\tthis.rooms[ key ].unit.x + x,\n\t\t\tthis.rooms[ key ].unit.y + y\n\t\t)\n\t\t\t.max(new Vec2(800 - UNIT_RAD, 400 - UNIT_RAD))\n\t\t\t.min(new Vec2(0 + UNIT_RAD, 0 + UNIT_RAD));\n\n\t\tconst diff = Math.abs(this.rooms[ key ].unit.x - coords.x)\n\t\t\t+ Math.abs(this.rooms[ key ].unit.y - coords.y);\n\n\t\tif (diff < 0.1 && diff > 0) {\n\t\t\tthis.rooms[ key ].unit.life -= 0.5 - diff;\n\t\t} else if (diff < 0.001) {\n\t\t\tthis.rooms[ key ].unit.life -= 1;\n\t\t}\n\n\t\tthis.rooms[ key ].unit.x = coords.x;\n\t\tthis.rooms[ key ].unit.y = coords.y;\n\n\t\treturn this.rooms[ key ].unit;\n\n\t}\n\n\tcheckEat(unit, key) {\n\n\t\tthis.rooms[ key ].foods.map((food, _key) => {\n\t\t\t\n\t\t\tif (Vec2.Sub(food, unit).length < UNIT_RAD + FOOD_RAD ) {\n\t\t\t\t\n\t\t\t\tthis.rooms[ key ].foods.splice(_key, 1);\n\t\t\t\tthis.rooms[ key ].unit.score += 1;\n\t\t\t\tthis.rooms[ key ].unit.life += 40;\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t});\n\n\t\treturn this.rooms[ key ].unit.score;\n\n\t}\n\n\tstep() {\n\n\t\treturn this.rooms.map((room, key) => {\n\n\t\t\tlet lines = this.getUnitLines(room.unit, key);\n\t\t\tlet score = this.rooms[ key ].unit.score;\n\t\t\tif (room.unit.life > 0) {\n\t\t\t\tconst signals = this.getUnitSignals(lines);\n\t\t\t\tconst movement = room.unit.mind.process(signals);\n\t\t\t\tconst movedUnit = this.moveUnit(movement, key);\n\t\t\t\tscore = this.checkEat(movedUnit, key);\n\t\t\t\tthis.rooms[ key ].unit.life += -0.1;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tunits: [{\n\t\t\t\t\tx: this.rooms[ key ].unit.x,\n\t\t\t\t\ty: this.rooms[ key ].unit.y,\n\t\t\t\t\tradius: UNIT_RAD,\n\t\t\t\t\tlines,\n\t\t\t\t\tscore,\n\t\t\t\t\tlife: this.rooms[ key ].unit.life\n\t\t\t\t}],\n\t\t\t\tfood: this.rooms[ key ].foods,\n\t\t\t\tend: this.rooms[ key ].unit.life <= 0\n\t\t\t}\n\n\t\t});\n\n\t}\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/simulator/index.js","import Layer from './layer';\nimport ACTIVATE_FUNCTIONS from './activate_functions';\n\nexport default class Network {\n\n\tconstructor(params) {\n\n\t\tthis.params = {\n\t\t\t...Network.defaultParams,\n\t\t\t...params\n\t\t}\n\n\t\tthis.layers = this.params.layers.map(p => new Layer(p));\n\n\t}\n\n\tstatic defaultParams = {\n\t\tlayers: []\n\t};\n\t\n\tstatic ACTIVATE_FUNCTIONS = ACTIVATE_FUNCTIONS;\n\n\taddLayer(params) {\n\n\t\tthis.layers.push(new Layer(params));\n\n\t}\n\n\tprocess(input) {\n\n\t\tif (!this.layers.length) {\n\n\t\t\t// return Promise.resolve(null);\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// return new Promise((resolve, reject) => {\n\n\t\t\tfor (let i = 0; i < this.layers.length; i++) {\n\n\t\t\t\tconst _in = i == 0 ? input : this.layers[ i - 1 ].signals;\n\t\t\t\tthis.layers[ i ].process(_in);\n\n\t\t\t}\n\n\t\t\treturn this.layers[ this.layers.length - 1 ].signals;\n\n\t\t// });\n\n\t}\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/neuro_net/network.js","import Neuron from './neuron';\n\nexport default class Layer {\n\n\tconstructor(params) {\n\n\t\tthis.params = {\n\t\t\t...Layer.defaultParams,\n\t\t\t...params\n\t\t}\n\n\t\tthis.neurons = new Array(this.params.length)\n\t\t\t.fill(null)\n\t\t\t.map((n, key) => new Neuron({\n\t\t\t\tweights: this.params.weights[ key ] || [],\n\t\t\t\tdomain: this.params.domain,\n\t\t\t\tdefaultOut: this.params.defaultOut,\n\t\t\t\tactivateFunction: this.params.activateFunction,\n\t\t\t}));\n\n\t\tthis.out = this.params.defaultOut;\n\n\t}\n\n\tstatic defaultParams = {\n\t\tweights: [],\n\t\tdomain: [0,1],\n\t\tdefaultOut: 0,\n\t\tactivateFunction: 'threshold',\n\t\tlength: 0\n\t}\n\n\taddNeuron(params) {\n\n\t\tthis.neurons.push(new Neuron({\n\t\t\tweights: [],\n\t\t\tdomain: this.params.domain,\n\t\t\tdefaultOut: this.params.defaultOut,\n\t\t\tactivateFunction: this.params.activateFunction,\n\t\t\t...params\n\t\t}));\n\n\t}\n\n\tprocess(signals) {\n\n\t\tthis.out = this.neurons.map(neuron => neuron.process(signals));\n\t\treturn this.out;\n\n\t}\n\n\tget signals() {\n\n\t\treturn this.out;\n\n\t}\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/neuro_net/layer.js","import ACTIVATE_FUNCTIONS from './ready_functions';\n\nexport default class Neuron {\n\n\tconstructor(params) {\n\n\t\tthis.params = {\n\t\t\t...Neuron.defaultParams,\n\t\t\t...params\n\t\t}\n\n\t\tthis.activationFunc = Neuron.GetActivationFunc(this.params.activateFunction);\n\t\tthis.out = this.params.defaultOut;\n\n\t}\n\n\tstatic defaultParams = {\n\t\tweights: [],\n\t\tdomain: [0,1],\n\t\tdefaultOut: 0,\n\t\tactivateFunction: 'threshold'\n\t}\n\n\tstatic GetActivationFunc(func) {\n\n\t\tswitch (typeof func) {\n\n\t\t\tcase 'function':\n\n\t\t\t\treturn func;\n\n\t\t\tcase 'string':\n\n\t\t\t\treturn ACTIVATE_FUNCTIONS[ func ];\n\n\t\t\tdefault:\n\n\t\t\t\tthrow new Error('Neuron\\'s \\'activateFunction\\' param must be a string of function');\n\n\t\t}\n\n\t}\n\n\tprocess(signals) {\n\n\t\tthis.out = this.activationFunc(this.sum(signals));\n\t\treturn this.out;\n\n\t}\n\n\tsum(signals) {\n\n\t\tlet sum = 0;\n\n\t\tfor (let i = 0; i < signals.length; i++) {\n\n\t\t\tconst weight = this.params.weights[ i ];\n\n\t\t\tif (!Number.isFinite(weight) || !Number.isFinite(signals[ i ])) {\n\n\t\t\t\tthrow new Error(`Signal or weight is not finite: weight ${weight}, signal ${signals[ i ]}`);\n\n\t\t\t}\n\n\t\t\tsum += signals[ i ] * weight;\n\n\t\t}\n\n\t\treturn sum;\n\n\t}\n\n\tget signal() {\n\n\t\treturn this.out;\n\n\t}\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/neuro_net/neuron.js","import ACTIVATE_FUNCTIONS from './activate_functions';\n\nconst functions = {};\n\nObject.keys(ACTIVATE_FUNCTIONS).map(key => {\n\n\tlet func = () => {};\n\n\tswitch (key) {\n\n\t\tcase 'threshold':\n\n\t\t\tfunc = ACTIVATE_FUNCTIONS[ key ].bind(null, 0, 1, 0.5);\n\n\t\tcase 'gisterezis':\n\n\t\t\tfunc = ACTIVATE_FUNCTIONS[ key ].bind(null, 0, 1, 0.35, 0.65);\n\n\t\tcase 'sigmoid':\n\n\t\t\tfunc = ACTIVATE_FUNCTIONS[ key ].bind(null, 0, 1, 1);\n\n\n\t}\n\n\tfunctions[ key ] = func;\n\t\n});\n\nexport default functions;\n\n\n// WEBPACK FOOTER //\n// ./src/neuro_net/ready_functions.js","export default {\n\n\t'threshold': (min, max, t, s) => {\n\n\t\treturn s > t ? max : min;\n\n\t},\n\t'gisterezis': (min, max, p1, p2, s) => {\n\n\t\treturn s <= p1\n\t\t\t? min\n\t\t\t: s >= p2\n\t\t\t? max\n\t\t\t: min + ((max - min) * ((s - p1) / (p2 - p1)));\n\n\t},\n\t'sigmoid': (min, max, A, s) => {\n\n\t\treturn 1 / (1 + Math.exp(-A * (s - (max - min) / 2)))\n\n\t}\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/neuro_net/activate_functions.js","// import { Node } from 'quantizer/state';\n// import { isMap } from '../types/types';\n\n/**\n * Creates a new Vec2.\n * @class\n */\n\nclass Vec2 {\n\n\tconstructor(x, y) {\n\n\t\tif ( typeof x === 'object' ) {\n\n\t\t\tthis.set(x);\n\n\t\t} else {\n\n\t\t\tthis.x = x || 0;\n\t\t\tthis.y = y || 0;\n\n\t\t}\n\n\n\n\t}\n\n\tstatic From(obj) {\n\n\t\treturn new Vec2().set(obj);\n\n\t}\n\n\t/**\n\t * Summary two vectors.\n\t *\n\t * @static\n\t * @param { Vec2 } vec1 - first vector\n\t * @param { Vec2 } vec2 - second vector\n\t * @returns { Vec2 }\n\t */\n\n\tstatic Add(vec1, vec2) {\n\n\t\treturn new Vec2(vec1.x + vec2.x, vec1.y + vec2.y);\n\n\t}\n\n\t/**\n\t * Subvector two vectors.\n\t *\n\t * @static\n\t * @param { Vec2 } vec1 - first vector\n\t * @param { Vec2 } vec2 - second vector\n\t * @returns { Vec2 }\n\t */\n\n\tstatic Sub(vec1, vec2) {\n\n\t\treturn new Vec2(vec1.x - vec2.x, vec1.y - vec2.y);\n\n\t}\n\n\t/**\n\t * Multiply two vectors.\n\t *\n\t * @static\n\t * @param { Vec2 } vec1 - first vector\n\t * @param { Vec2 } vec2 - second vector\n\t * @returns { Vec2 }\n\t */\n\n\tstatic Multiply(vec1, vec2) {\n\n\t\treturn new Vec2(vec1.x * vec2.x, vec1.y * vec2.y);\n\n\t}\n\n\t/**\n\t * Divide 2 argument vectors.\n\t *\n\t * @static\n\t * @param { Vec2 } vec1 - first vector\n\t * @param { Vec2 } vec2 - second vector\n\t * @returns { Vec2 }\n\t */\n\n\tstatic Divide(vec1, vec2) {\n\n\t\treturn new Vec2(vec1.x / vec2.x, vec1.y / vec2.y);\n\n\t}\n\n\t/**\n\t * Distance between 2 argument vectors.\n\t *\n\t * @static\n\t * @param { Vec2 } vec1 - first vector\n\t * @param { Vec2 } vec2 - second vector\n\t * @returns { Number }\n\t */\n\n\tstatic Distance(vec1, vec2) {\n\n\t\treturn Math.sqrt(Math.pow(vec1.x - vec2.x, 2) + Math.pow(vec1.y - vec2.y, 2));\n\n\t}\n\n\t/**\n\t * Dot product\n\t *\n\t * @param { Vec2 } vec1 - first vector\n\t * @param { Vec2 } vec2 - second vector\n\t * @returns {number}\n\t */\n\n\tstatic DotProduct(vec1, vec2) {\n\n\t\treturn vec1.x * vec2.x + vec1.y * vec2.y;\n\n\t}\n\n\t/**\n\t * Projecting vector to vector\n\t *\n\t * @param { Vec2 } vec1 - first vector\n\t * @param { Vec2 } vec2 - second vector\n\t * @returns { Vec2 }\n\t */\n\n\tstatic Project(vec1, vec2) {\n\n\t\tconst d = vec2.dotProduct(vec2);\n\n\t\tif (d > 0) {\n\n\t\t\tconst dp = vec1.dotProduct(vec2);\n\t\t\tconst multiplier = dp / d;\n\t\t\treturn vec2.multScalar(multiplier);\n\n\t\t}\n\t\treturn new Vec2(0, 0);\n\n\t}\n\n\t/**\n\t * Get angle between two vectors\n\t *\n\t * @param { Vec2 } vec1 - first vector\n\t * @param { Vec2 } vec2 - second vector\n\t * @returns {number}\n\t */\n\t\n\tstatic Angle(vec1, vec2) {\n\n\t\treturn vec1.dotProduct(vec2) / (vec1.length * vec2.length);\n\t\t\n\t}\n\n\t/**\n\t * Get vector object.\n\t *\n\t * @returns { Object }\n\t */\n\n\tget() {\n\n\t\tlet result = {};\n\n\t\tif (arguments.length) {\n\n\t\t\tfor (let name in arguments[ 0 ]) {\n\n\t\t\t\tresult[ name ] = this[ name ];\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tresult = {\n\t\t\t\tx: this.x,\n\t\t\t\ty: this.y\n\t\t\t};\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tsub(vec2) {\n\n\t\treturn Vec2.Sub(this, vec2);\n\n\t}\n\n\tadd(vec2) {\n\n\t\treturn Vec2.Add(this, vec2);\n\n\t}\n\n\tmult(vec2) {\n\n\t\treturn Vec2.Multiply(this, vec2);\n\n\t}\n\n\t/**\n\t * Set vector object.\n\t *\n\t * @param { Object } source - Source value.\n\t * @returns { Vec2 }\n\t */\n\n\tset() {\n\n\t\tfor (let name in arguments[ 0 ]) {\n\n\t\t\tthis[ name ] = arguments[ 0 ][ name ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetX(value) {\n\n\t\treturn new Vec2(value, this.y);\n\n\t}\n\n\n\tsetY(value) {\n\n\t\treturn new Vec2(this.x, value);\n\n\t}\n\n\t/**\n\t *  Get vector length.\n\t *\n\t *  @returns { Number }\n\t */\n\n\tget length() {\n\n\t\treturn Math.sqrt(this.x * this.x + this.y * this.y);\n\n\t}\n\n\t/**\n\t *  Get modified vector by multiply coords.\n\t *\n\t *  @returns { Vec2 }\n\t */\n\n\tmultScalar(scalar) {\n\n\t\treturn new Vec2(this.x * scalar, this.y * scalar);\n\n\t}\n\n\t/**\n\t *  Get inverted vector.\n\t *\n\t *  @returns { Vec2 }\n\t */\n\n\tinvert() {\n\n\t\treturn new Vec2(-this.x, -this.y);\n\n\t}\n\n\t/**\n\t *  Get vector by x coord.\n\t *\n\t *  @returns { Vec2 }\n\t */\n\n\tinvertX() {\n\n\t\treturn new Vec2(-this.x, this.y);\n\n\t}\n\n\t/**\n\t *  Get vector by y coord.\n\t *\n\t *  @returns { Vec2 }\n\t */\n\n\tinvertY() {\n\n\t\treturn new Vec2(this.x, -this.y);\n\n\t}\n\n\t/**\n\t *  Clone vector.\n\t *\n\t *  @returns { Vec2 }\n\t */\n\n\tclone() {\n\n\t\treturn new Vec2(this.x, this.y);\n\n\t}\n\n\t/**\n\t *  Min vector.\n\t *\n\t * @param { Object } vec - min vector.\n\t *  @returns { Vec2 }\n\t */\n\n\tmin(vec) {\n\n\t\tif (this.x < vec.x) {\n\n\t\t\tthis.x = vec.x;\n\n\t\t}\n\n\t\tif (this.y < vec.y) {\n\n\t\t\tthis.y = vec.y;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t *  Normalize vector.\n\t *\n\t *  @returns { Vec2 }\n\t */\n\n\tnormal() {\n\n\t\treturn new Vec2(Math.abs(this.x), Math.abs(this.y));\n\n\t}\n\n\t/**\n\t *  Max vector.\n\t *\n\t * @param { Object } vec - max vector.\n\t * @returns { Vec2 }\n\t */\n\n\tmax(vec) {\n\n\t\tif (this.x > vec.x) {\n\n\t\t\tthis.x = vec.x;\n\n\t\t}\n\n\t\tif (this.y > vec.y) {\n\n\t\t\tthis.y = vec.y;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tfromSize(size) {\n\n\t\tthis.set({\n\t\t\tx: size.w,\n\t\t\ty: size.h\n\t\t});\n\n\t}\n\n\ttoSize() {\n\n\t\treturn {\n\t\t\tw: this.x,\n\t\t\th: this.y\n\t\t};\n\n\t}\n\n\tdotProduct(vec) {\n\n\t\treturn Vec2.DotProduct(this, vec);\n\n\t}\n\n\tproject(vec) {\n\n\t\treturn Vec2.Project(this, vec);\n\n\t}\n\n\tangle(vec) {\n\n\t\treturn Vec2.Angle(this, vec);\n\n\t}\n\n}\n\nexport default Vec2;\n\n\n\n// WEBPACK FOOTER //\n// ./src/math/vec2.js","export default class Evolver {\n\n\tconstructor(params) {\n\n\t\tthis.params = {\n\t\t\t...Evolver.DEFAULT_CONFIG,\n\t\t\t...params,\n\t\t}\n\n\t\tthis.population = null;\n\n\t}\n\n\tstatic DEFAULT_CONFIG = {\n\t\tpopulationSize: 10,\n\t\tnumberOfGenes: 10,\n\t\tnumberOfWinners: 2,\n\t\tgenesToMutate: 1,\n\t\tmutationRate: 0.05\n\t}\n\n\tinitRandomPopulation() {\n\n\t\tconst population = [];\n\t\tconst { populationSize, numberOfGenes } = this.params;\n\n\t\tfor (let unit = 0; unit < populationSize; unit++) {\n\n\t\t\tconst genes = [];\n\n\t\t\tfor (let gen = 0; gen < numberOfGenes; gen++) {\n\n\t\t\t\tgenes.push(Math.random());\n\n\t\t\t}\n\n\t\t\tpopulation.push(genes);\n\n\t\t}\n\n\t\tthis.population = population;\n\n\t}\n\n\tcross(genome1, genome2) {\n\n\t\tconst genomes = [genome1, genome2];\n\t\tconst child = [];\n\n\t\tfor (let i = 0; i < this.params.numberOfGenes; i++) {\n\t\t\tchild.push(genomes[ Math.round(Math.random()) ][ i ]);\n\t\t}\n\t\treturn child;\n\n\t}\n\n\tselect(marks) {\n\n\t\tconst marked = this.population.map((unit, key) => ({ unit, mark: marks[ key ] }));\n\t\tmarked.sort((a, b) => {\n\n\t\t\tif (a.mark > b.mark) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tif (a.mark < b.mark) {\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\treturn 0;\n\n\t\t});\n\n\t\treturn marked.slice(0, this.params.numberOfWinners);\n\n\t}\n\n\tcrossing(parents) {\n\t\t\n\t\tparents = parents.map(obj => obj.unit);\n\t\tconst res = parents;\n\t\tlet counter = 1;\n\t\tconst _l = parents.length;\n\t\twhile (res.length < this.params.populationSize) {\n\n\t\t\tconst parent1 = parents[ _l - counter % _l - 1];\n\t\t\tconst parent2 = parents[ _l - (counter + 1) % _l - 1];\n\t\t\tconst child = this.cross(parent1, parent2);\n\t\t\tres.push(child);\n\t\t\tcounter++;\n\n\t\t}\n\t\treturn res;\n\t\t\n\t}\n\t\n\tmutate(prepopulation) {\n\t\t\n\t\treturn prepopulation.map(genome => {\n\n\t\t\tfor (let i = 0; i < this.params.genesToMutate; i++) {\n\n\t\t\t\tconst at = Math.round(Math.random() * genome.length - 1);\n\t\t\t\tgenome[ at ]\n\t\t\t\t\t+= this.params.mutationRate * (Math.random() > 0.5 ? 1 : -1);\n\n\t\t\t}\n\n\t\t\treturn genome;\n\n\t\t});\n\t\t\n\t}\n\n\tevolve(marks) {\n\n\t\tthis.population = this\n\t\t\t.mutate(\n\t\t\t\tthis.crossing(\n\t\t\t\t\tthis.select(marks)\n\t\t\t\t)\n\t\t\t);\n\n\t\treturn this.population;\n\n\t}\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/evolve/index.js","class UIController {\n\n\tconstructor() {\n\n\t\tthis.callback = () => {};\n\n\t}\n\n\tinit(obj) {\n\t\t\n\t\tthis.putButtons(\n\t\t\tobj.options.visibleUnit,\n\t\t\tobj.options.populationSize,\n\t\t\tobj.current.map(u => u.unit)\n\t\t);\n\t\tthis.putPlayPause();\n\t\tthis.putPopulationNum(obj.populationNum);\n\n\t}\n\n\tsetCallback(func) {\n\n\t\tthis.callback = func;\n\n\t}\n\n\tsetStyle(node, style) {\n\n\t\tfor (let i in style) {\n\n\t\t\tnode.style[ i ] = style[ i ];\n\n\t\t}\n\n\t}\n\t\n\tupdate({ units, visible, highlight, populationNum }) {\n\n\t\tconst cont = document.querySelector('#buttons_cont');\n\t\tconst pop = document.querySelector('#num');\n\t\tif (cont) {\n\t\t\tunits.map((o, key) => {\n\t\t\t\tconst c = cont.children[key];\n\t\t\t\tconst life = Math.max(Math.min(o.life, 100), 0);\n\t\t\t\tconst btn = c.children[ 0 ];\n\t\t\t\tconst graph = c.children[ 1 ];\n\t\t\t\tconst color = `rgb(${\n\t\t\t\t\tMath.round(255 - (life / 100 * 255))\n\t\t\t\t\t}, ${Math.round(life / 100 * 255)}, 0)`;\n\t\t\t\tbtn.style.color = visible === key + 1 ? 'green' : 'black';\n\t\t\t\tbtn.style.fontWeight = visible === key + 1 ? 'bold' : 'normal';\n\t\t\t\tbtn.style.backgroundColor = highlight === key ? 'lightblue' : 'transparent';\n\t\t\t\tgraph.style.height = `${life / 2}px`;\n\t\t\t\tgraph.style.backgroundColor = color;\n\t\t\t\tgraph.innerHTML = o.score;\n\t\t\t});\n\t\t}\n\t\tif (pop) {\n\t\t\tpop.innerHTML = `Population: ${populationNum}`;\n\t\t}\n\t\t\n\t}\n\n\tcreateElement(i, selected) {\n\n\t\tconst style = {\n\t\t\tborder: '1px solid black',\n\t\t\tfontSize: '16px',\n\t\t\twidth: '30px',\n\t\t\theight: '30px',\n\t\t\tcolor: 'black',\n\t\t\tlineHeight: '30px',\n\t\t\tcursor: 'pointer',\n\t\t\tfontWeight: 'normal'\n\t\t};\n\n\t\tconst selStyle = {\n\t\t\tcolor: 'green',\n\t\t\tfontWeight: 'bold'\n\t\t}\n\n\t\tconst cont = document.createElement('div');\n\t\tcont.id = i;\n\t\tthis.setStyle(cont, {\n\t\t\tdisplay: 'inline-block',\n\t\t\tmarginLeft: '-1px',\n\t\t});\n\t\tconst el = document.createElement('div');\n\t\tthis.setStyle(el, Object.assign({}, style, selected === i ? selStyle : {}));\n\t\tel.innerText = i;\n\t\tel.onclick = () => {\n\t\t\tthis.callback('options', { visibleUnit: i });\n\t\t};\n\n\t\tcont.appendChild(el);\n\n\t\tconst score = document.createElement('div');\n\t\tscore.innerHTML = 0;\n\t\tthis.setStyle(score, {\n\t\t\theight: `50px`,\n\t\t\twidth: '100%',\n\t\t\tbackgroundColor: `green`\n\t\t});\n\n\t\tcont.appendChild(score);\n\n\t\treturn cont;\n\n\t}\n\n\tputButtons(selected, num) {\n\n\t\tconst cont = document.createElement('div');\n\t\tcont.id = 'buttons_cont';\n\t\tdocument.body.appendChild(cont);\n\n\t\tthis.setStyle(cont, { textAlign: 'center' });\n\n\t\tconst arr = new Array(num)\n\t\t\t.fill(null)\n\t\t\t.map((a, key) => key + 1);\n\t\tarr.push('HS');\n\t\tarr.map((i) => {\n\n\t\t\tconst el = this.createElement(i, selected);\n\t\t\tcont.appendChild(el);\n\n\t\t});\n\n\t}\n\n\tputPlayPause() {\n\n\t\tconst btn = document.createElement('div');\n\t\tbtn.id = 'play';\n\t\tbtn.innerHTML = 'Play/Pause';\n\t\tthis.setStyle(btn, {\n\t\t\twidth: '100px',\n\t\t\tmargin: '20px auto',\n\t\t\tcursor: 'pointer'\n\t\t});\n\t\tbtn.onclick = () => {\n\t\t\tthis.callback('play');\n\t\t}\n\n\t\tdocument.body.appendChild(btn);\n\n\t}\n\n\tputPopulationNum(num) {\n\n\t\tconst inf = document.createElement('div');\n\t\tinf.id = 'num';\n\t\tinf.innerHTML = `Population: ${num}`;\n\t\tthis.setStyle(inf, {\n\t\t\twidth: '100px',\n\t\t\tmargin: '20px auto',\n\t\t});\n\n\t\tdocument.body.appendChild(inf);\n\n\t}\n\n}\n\nexport default new UIController();\n\n\n// WEBPACK FOOTER //\n// ./src/ui_controller.js"],"sourceRoot":""}