{"version":3,"sources":["webpack:///webpack/bootstrap dc5154078c18255d9780","webpack:///./src/index.js","webpack:///./src/drawer/index.js","webpack:///./src/main/index.js","webpack:///./src/simulator/index.js","webpack:///./src/neuro_net/network.js","webpack:///./src/neuro_net/layer.js","webpack:///./src/neuro_net/neuron.js","webpack:///./src/neuro_net/ready_functions.js","webpack:///./src/neuro_net/activate_functions.js","webpack:///./src/math/vec2.js","webpack:///./src/ui_controller.js"],"names":["window","PARTS_NUM","UNIT_RAD","FOOD_RAD","LINE_LENGTH","drawer","document","getElementById","MainController","ui","CanvasDrawer","canvas","params","width","height","ctx","getContext","source","end","color","strokeStyle","beginPath","moveTo","x","y","lineTo","stroke","frameData","clear","fillStyle","units","map","drawUnit","food","drawFoodItem","unit","score","lines","radius","font","textAlign","textBaseline","fillText","arc","Math","PI","drawCanvasLine","line","from","to","active","item","fill","clearRect","opts","setCallback","actionHandler","population","simulator","Array","round","random","options","visibleUnit","populationSize","current","status","init","type","value","Object","assign","draw","update","u","start","pause","t","weights","drawFrame","getViewebleUnitIndex","i","filter","life","sort","a","b","indexOf","clearInterval","interval","setInterval","step","NETWORK_PARAMS","layers","length","activateFunction","Simulator","rooms","foods","mind","key","main_vector","sub","point","circlePoint","project","_vec","add","vec_length","begintInter","endInter","isInterruct","DotProduct","interSect","projectedPoint","ort","multScalar","l","sqrt","p1","p2","filtered","p","_a","Sub","_b","endPoints","concat","findCollisions","min","res","full","part","curDeg","vec","cos","sin","push","processLine","movement","coords","max","diff","abs","_key","splice","room","getUnitLines","signals","getUnitSignals","process","movedUnit","moveUnit","checkEat","Network","defaultParams","input","_in","ACTIVATE_FUNCTIONS","Layer","neurons","n","domain","defaultOut","out","neuron","Neuron","activationFunc","GetActivationFunc","sum","weight","Number","isFinite","Error","func","functions","keys","bind","s","A","exp","Vec2","set","result","arguments","name","vec2","Add","Multiply","scalar","size","w","h","Project","Angle","obj","vec1","pow","d","dotProduct","dp","multiplier","UIController","callback","putButtons","putPlayPause","node","style","visible","highlight","cont","querySelector","o","c","children","btn","graph","fontWeight","backgroundColor","innerHTML","selected","border","fontSize","lineHeight","cursor","selStyle","createElement","id","setStyle","display","marginLeft","el","innerText","onclick","appendChild","num","body","arr","margin"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap dc5154078c18255d9780","import CanvasDrawer from './drawer';\nimport MainController from './main';\nimport UIController from './ui_controller';\n\nwindow.PARTS_NUM = 15;\nwindow.UNIT_RAD = 30;\nwindow.FOOD_RAD = 8;\nwindow.LINE_LENGTH = 25;\n\nwindow.drawer = new CanvasDrawer(document.getElementById('canvas'));;\nwindow.MainController = new MainController({ drawer, ui: UIController });\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","export default class CanvasDrawer {\n\n\tconstructor(canvas) {\n\n\t\tthis.params = {\n\t\t\twidth: canvas.width,\n\t\t\theight: canvas.height,\n\t\t}\n\n\t\tthis.ctx = canvas.getContext('2d');\n\n\t}\n\n\t// drawSmallPoint(coords, radius, color) {\n\t//\n\t// \tthis.ctx.fillStyle = color;\n\t// \tthis.ctx.beginPath();\n\t// \tthis.ctx.arc(coords.x, coords.y, radius, 0, Math.PI * 2, false);\n\t// \tthis.ctx.fill();\n\t//\n\t// }\n\n\tdrawCanvasLine(source, end, color) {\n\n\t\tthis.ctx.strokeStyle = color;\n\t\tthis.ctx.beginPath();\n\t\tthis.ctx.moveTo(source.x,source.y);\n\t\tthis.ctx.lineTo(end.x,end.y);\n\t\tthis.ctx.stroke();\n\n\t}\n\n\tdrawFrame(frameData) {\n\n\t\tthis.clear();\n\n\t\tthis.ctx.strokeStyle = '#40484f';\n\t\tthis.ctx.fillStyle = '#0abe55';\n\n\t\tframeData\n\t\t\t.units\n\t\t\t.map(::this.drawUnit);\n\n\t\tframeData\n\t\t\t.food\n\t\t\t.map(::this.drawFoodItem);\n\n\n\t}\n\n\tdrawUnit(unit) {\n\n\t\tconst { x, y, score, lines } = unit;\n\n\t\tthis.ctx.beginPath();\n\t\tconst radius = UNIT_RAD;\n\n\t\tthis.ctx.font = \"24px Arial\";\n\t\tthis.ctx.textAlign = \"center\";\n\t\tthis.ctx.textBaseline = \"middle\";\n\t\tthis.ctx.strokeStyle = 'black';\n\t\tthis.ctx.fillText(score, unit.x, unit.y);\n\t\tthis.ctx.arc(x, y, radius, 0, Math.PI * 2, false);\n\t\tthis.ctx.stroke();\n\n\t\tlines.map(line =>\n\t\t\tthis.drawCanvasLine(line.from, line.to, line.active ? 'green' : 'black'));\n\n\t}\n\n\tdrawFoodItem(item) {\n\n\t\tconst { x, y } = item;\n\n\t\tthis.ctx.beginPath();\n\t\tconst radius = FOOD_RAD;\n\n\t\tthis.ctx.arc(x, y, radius, 0, Math.PI * 2, false);\n\t\tthis.ctx.fill();\n\n\t}\n\n\tclear() {\n\n\t\tthis.ctx.clearRect(0, 0, this.params.width, this.params.height);\n\n\t}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/drawer/index.js","import World from '../simulator';\nimport Vec2 from '../math/vec2';\n\nexport default class MainController {\n\n\tconstructor(opts) {\n\n\t\tthis.drawer = opts.drawer;\n\t\tthis.ui = opts.ui;\n\t\tthis.ui.setCallback(::this.actionHandler);\n\n\t\tthis.population = [];\n\t\tthis.simulator = new World();\n\t\tthis.food = new Array(Math.round(Math.random() * 100))\n\t\t\t.fill(null)\n\t\t\t.map(() => {\n\n\t\t\t\treturn new Vec2(\n\t\t\t\t\tMath.random() * 800,\n\t\t\t\t\tMath.random() * 400,\n\t\t\t\t);\n\n\t\t\t});\n\n\t\tthis.options = {\n\t\t\tvisibleUnit: 'HS',\n\t\t\tpopulationSize: 10\n\t\t}\n\n\t\tthis.current = [];\n\t\tthis.status = 'paused';\n\n\t\tthis.init();\n\n\t}\n\n\tactionHandler(type, value) {\n\n\t\tswitch (type) {\n\n\t\t\tcase 'options':\n\n\t\t\t\tthis.options = Object.assign(this.options, value);\n\n\t\t\t\tif (typeof value.visibleUnit != 'undefined') {\n\n\t\t\t\t\tthis.draw();\n\t\t\t\t\tthis.ui.update(this.current.map(u => u.units[0], this.options.visibleUnit));\n\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'play':\n\n\t\t\t\tif (this.status == 'paused') {\n\t\t\t\t\tthis.start();\n\t\t\t\t} else if (this.status == 'started') {\n\t\t\t\t\tthis.pause();\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t}\n\n\n\t}\n\n\tinit(t) {\n\n\t\tthis.population = new Array(this.options.populationSize)\n\t\t\t.fill(null)\n\t\t\t.map(() => ({\n\t\t\t\tx: 400,\n\t\t\t\ty: 200,\n\t\t\t\tweights: [\n\t\t\t\t\tnew Array(15)\n\t\t\t\t\t\t.fill(null)\n\t\t\t\t\t\t.map(() => new Array(15)\n\t\t\t\t\t\t\t.fill(null)\n\t\t\t\t\t\t\t.map(() => Math.random())\n\t\t\t\t\t\t)\n\t\t\t\t\t,\n\t\t\t\t\tnew Array(15)\n\t\t\t\t\t\t.fill(null)\n\t\t\t\t\t\t.map(() => new Array(15)\n\t\t\t\t\t\t\t.fill(null)\n\t\t\t\t\t\t\t.map(() => Math.random())\n\t\t\t\t\t\t)\n\t\t\t\t]\n\t\t\t}));\n\n\t\tthis.simulator.init(this.population, this.food);\n\t\tthis.ui.init(this);\n\t\tthis.start(t);\n\t}\n\n\tdraw() {\n\n\t\tthis.drawer.drawFrame(this.current[ this.getViewebleUnitIndex() ]);\n\n\t}\n\n\tgetViewebleUnitIndex() {\n\n\t\tif (this.options.visibleUnit === 'HS') {\n\t\t\tconst i = this.current\n\t\t\t\t.filter(u => u.units[0].life > 0)\n\t\t\t\t.sort((a, b) => {\n\n\t\t\t\t\tif (a.units[0].score > b.units[0].score) {\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\t}\n\t\t\t\t\tif (a.units[0].score < b.units[0].score) {\n\t\t\t\t\t\treturn 1;\n\t\t\t\t\t}\n\t\t\t\t\treturn 0;\n\n\t\t\t\t})[ 0 ];\n\t\t\treturn this.current.indexOf(i);\n\t\t}\n\n\t\treturn this.options.visibleUnit - 1;\n\n\t}\n\n\tstart(t) {\n\n\t\tthis.status = 'started';\n\t\tclearInterval(this.interval);\n\t\tthis.interval = setInterval(() => {\n\t\t\tthis.step();\n\t\t}, t || 10);\n\n\t}\n\n\tpause() {\n\n\t\tthis.status = 'paused';\n\t\tclearInterval(this.interval);\n\n\t}\n\n\tstep() {\n\n\t\tthis.current = this.simulator.step();\n\t\tthis.ui.update(\n\t\t\tthis.current.map(u => u.units[0]),\n\t\t\tthis.options.visibleUnit,\n\t\t\tthis.getViewebleUnitIndex()\n\t\t);\n\t\tif (this.current.map(u => u.end).indexOf(false) === -1) {\n\n\t\t\tthis.pause();\n\n\t\t} else {\n\n\t\t\tthis.draw();\n\n\t\t}\n\n\t}\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/main/index.js","import Net from '../neuro_net/network';\nimport Vec2 from '../math/vec2';\n\nconst NETWORK_PARAMS = (weights) => {\n\treturn {\n\t\tlayers: [\n\t\t\t{\n\t\t\t\tweights: weights[ 0 ],\n\t\t\t\tlength: weights[ 0 ].length,\n\t\t\t\tactivateFunction: 'sigmoid'\n\t\t\t},\n\t\t\t{\n\t\t\t\tweights: weights[ 1 ],\n\t\t\t\tlength: weights[ 1 ].length,\n\t\t\t\tactivateFunction: 'sigmoid'\n\t\t\t}\n\t\t]\n\t}\n}\n\nexport default class Simulator {\n\n\tconstructor() {\n\n\t\tthis.rooms = [{\n\t\t\tunits: [],\n\t\t\tfoods: []\n\t\t}];\n\n\t}\n\n\tinit(units, foods) {\n\n\t\tthis.rooms = units.map(u => {\n\t\t\treturn {\n\t\t\t\tunit: {\n\t\t\t\t\t...u,\n\t\t\t\t\tscore: 0,\n\t\t\t\t\tmind: new Net(NETWORK_PARAMS(u.weights)),\n\t\t\t\t\tlife: 100\n\t\t\t\t},\n\t\t\t\tfoods: foods.map(food => food)\n\t\t\t}\n\t\t});\n\n\t}\n\n\tfindCollisions(source, end, key) {\n\n\t\treturn this.rooms[ key ].foods.map(circlePoint => {\n\n\t\t\tconst main_vector = end.sub(source);\n\n\t\t\tconst point = circlePoint.sub(source).project(main_vector);\n\t\t\tconst _vec = point.add(source).sub(circlePoint);\n\n\t\t\tconst radius = FOOD_RAD;\n\t\t\tconst vec_length = _vec.length;\n\t\t\tconst begintInter = source.sub(circlePoint).length < radius;\n\t\t\tconst endInter = end.sub(circlePoint).length < radius;\n\n\t\t\tconst isInterruct = vec_length < radius\n\t\t\t\t&& Vec2.DotProduct(point, main_vector) >= 0\n\t\t\t\t&& main_vector.length >= point.length;\n\t\t\tconst interSect = isInterruct || (begintInter || endInter);\n\n\t\t\tif (interSect) {\n\n\t\t\t\tconst projectedPoint = point.add(source);\n\t\t\t\tconst ort = main_vector.multScalar(1/main_vector.length);\n\t\t\t\tconst l = Math.sqrt(radius*radius - vec_length*vec_length) * 2;\n\n\t\t\t\tconst p1 = projectedPoint.sub(ort.multScalar((l / 2)));\n\t\t\t\tconst p2 = projectedPoint.add(ort.multScalar((l / 2)));\n\n\t\t\t\tconst filtered = [p1, p2].filter(p => {\n\t\t\t\t\treturn ((p.x >= source.x && p.x <= end.x) || (p.x <= source.x && p.x >= end.x))\n\t\t\t\t\t\t&& ((p.y >= source.y && p.y <= end.y) || (p.y <= source.y && p.y >= end.y))\n\t\t\t\t}).sort((a, b) => {\n\n\t\t\t\t\tconst _a = Vec2.Sub(a, source).length;\n\t\t\t\t\tconst _b = Vec2.Sub(b, source).length;\n\n\t\t\t\t\tif (_a > _b) {\n\t\t\t\t\t\treturn 1;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (_a > _b) {\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn 0;\n\n\t\t\t\t})[0];\n\n\t\t\t\tif (filtered) {\n\n\t\t\t\t\treturn filtered;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn false;\n\n\t\t});\n\n\t}\n\n\tprocessLine(start, end, key) {\n\n\t\tconst endPoints = [end].concat(this.findCollisions(start, end, key));\n\t\tlet min = end.sub(start).length;\n\t\tlet res = end;\n\t\tlet active = false;\n\t\tendPoints.map(p => {\n\n\t\t\tif (p) {\n\t\t\t\tconst length = p.sub(start).length;\n\t\t\t\tif (length < min) {\n\t\t\t\t\tactive = true;\n\t\t\t\t\tmin = length;\n\t\t\t\t\tres = p;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn p;\n\n\t\t});\n\t\treturn {\n\t\t\tfrom: start,\n\t\t\tto: res,\n\t\t\tactive\n\t\t};\n\n\t}\n\n\tgetUnitLines(unit, key) {\n\n\t\tconst full = Math.PI * 2;\n\t\tconst part = full / PARTS_NUM;\n\t\tlet curDeg = -part;\n\t\tlet res = [];\n\n\t\tfor (let i = 0; i < PARTS_NUM; i++) {\n\n\t\t\tcurDeg += part;\n\t\t\tconst vec = new Vec2(\n\t\t\t\tMath.cos(curDeg),\n\t\t\t\tMath.sin(curDeg),\n\t\t\t);\n\n\t\t\tres.push(this.processLine(\n\t\t\t\tnew Vec2(unit).add(vec.multScalar(UNIT_RAD)),\n\t\t\t\tnew Vec2(unit).add(vec.multScalar(UNIT_RAD))\n\t\t\t\t\t.add(vec.multScalar(LINE_LENGTH)),\n\t\t\t\tkey\n\t\t\t));\n\n\t\t}\n\n\t\treturn res;\n\n\t}\n\n\tgetUnitSignals(lines) {\n\n\t\treturn lines.map(line =>\n\t\t(\n\t\t\tMath.round(\n\t\t\t\t(LINE_LENGTH - Math.min(line.to.sub(line.from).length, 25)) * 1000\n\t\t\t) / 1000) / LINE_LENGTH\n\t\t);\n\n\t}\n\n\tmoveUnit(movement, key) {\n\n\t\tconst full = Math.PI * 2;\n\t\tconst part = full / PARTS_NUM;\n\t\tlet curDeg = -part;\n\t\tlet x = 0;\n\t\tlet y = 0;\n\n\t\tfor (let i = 0; i < PARTS_NUM; i++) {\n\n\t\t\tcurDeg += part;\n\t\t\tx += movement[ i ] * Math.cos(curDeg) * 2;\n\t\t\ty += movement[ i ] * Math.sin(curDeg) * 2;\n\n\t\t}\n\n\t\tconst coords = new Vec2(\n\t\t\tthis.rooms[ key ].unit.x + x,\n\t\t\tthis.rooms[ key ].unit.y + y\n\t\t)\n\t\t\t.max(new Vec2(800 - UNIT_RAD, 400 - UNIT_RAD))\n\t\t\t.min(new Vec2(0 + UNIT_RAD, 0 + UNIT_RAD));\n\n\t\tconst diff = Math.abs(this.rooms[ key ].unit.x - coords.x)\n\t\t\t+ Math.abs(this.rooms[ key ].unit.y - coords.y);\n\n\t\tif (diff < 0.1 && diff > 0) {\n\t\t\tthis.rooms[ key ].unit.life -= 0.5 - diff;\n\t\t} else if (diff === 0) {\n\t\t\tthis.rooms[ key ].unit.life -= 1;\n\t\t}\n\n\t\tthis.rooms[ key ].unit.x = coords.x;\n\t\tthis.rooms[ key ].unit.y = coords.y;\n\n\t\treturn this.rooms[ key ].unit;\n\n\t}\n\n\tcheckEat(unit, key) {\n\n\t\tthis.rooms[ key ].foods.map((food, _key) => {\n\t\t\t\n\t\t\tif (Vec2.Sub(food, unit).length < UNIT_RAD + FOOD_RAD ) {\n\t\t\t\t\n\t\t\t\tthis.rooms[ key ].foods.splice(_key, 1);\n\t\t\t\tthis.rooms[ key ].unit.score += 1;\n\t\t\t\tthis.rooms[ key ].unit.life += 40;\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t});\n\n\t\treturn this.rooms[ key ].unit.score;\n\n\t}\n\n\tstep() {\n\n\t\treturn this.rooms.map((room, key) => {\n\n\t\t\tlet lines = this.getUnitLines(room.unit, key);\n\t\t\tlet score = this.rooms[ key ].unit.score;\n\t\t\tif (room.unit.life > 0) {\n\t\t\t\tconst signals = this.getUnitSignals(lines);\n\t\t\t\tconst movement = room.unit.mind.process(signals);\n\t\t\t\tconst movedUnit = this.moveUnit(movement, key);\n\t\t\t\tscore = this.checkEat(movedUnit, key);\n\t\t\t\tthis.rooms[ key ].unit.life += -0.1;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tunits: [{\n\t\t\t\t\tx: this.rooms[ key ].unit.x,\n\t\t\t\t\ty: this.rooms[ key ].unit.y,\n\t\t\t\t\tradius: UNIT_RAD,\n\t\t\t\t\tlines,\n\t\t\t\t\tscore,\n\t\t\t\t\tlife: this.rooms[ key ].unit.life\n\t\t\t\t}],\n\t\t\t\tfood: this.rooms[ key ].foods,\n\t\t\t\tend: this.rooms[ key ].unit.life <= 0\n\t\t\t}\n\n\t\t});\n\n\t}\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/simulator/index.js","import Layer from './layer';\nimport ACTIVATE_FUNCTIONS from './activate_functions';\n\nexport default class Network {\n\n\tconstructor(params) {\n\n\t\tthis.params = {\n\t\t\t...Network.defaultParams,\n\t\t\t...params\n\t\t}\n\n\t\tthis.layers = this.params.layers.map(p => new Layer(p));\n\n\t}\n\n\tstatic defaultParams = {\n\t\tlayers: []\n\t};\n\t\n\tstatic ACTIVATE_FUNCTIONS = ACTIVATE_FUNCTIONS;\n\n\taddLayer(params) {\n\n\t\tthis.layers.push(new Layer(params));\n\n\t}\n\n\tprocess(input) {\n\n\t\tif (!this.layers.length) {\n\n\t\t\t// return Promise.resolve(null);\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// return new Promise((resolve, reject) => {\n\n\t\t\tfor (let i = 0; i < this.layers.length; i++) {\n\n\t\t\t\tconst _in = i == 0 ? input : this.layers[ i - 1 ].signals;\n\t\t\t\tthis.layers[ i ].process(_in);\n\n\t\t\t}\n\n\t\t\treturn this.layers[ this.layers.length - 1 ].signals;\n\n\t\t// });\n\n\t}\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/neuro_net/network.js","import Neuron from './neuron';\n\nexport default class Layer {\n\n\tconstructor(params) {\n\n\t\tthis.params = {\n\t\t\t...Layer.defaultParams,\n\t\t\t...params\n\t\t}\n\n\t\tthis.neurons = new Array(this.params.length)\n\t\t\t.fill(null)\n\t\t\t.map((n, key) => new Neuron({\n\t\t\t\tweights: this.params.weights[ key ] || [],\n\t\t\t\tdomain: this.params.domain,\n\t\t\t\tdefaultOut: this.params.defaultOut,\n\t\t\t\tactivateFunction: this.params.activateFunction,\n\t\t\t}));\n\n\t\tthis.out = this.params.defaultOut;\n\n\t}\n\n\tstatic defaultParams = {\n\t\tweights: [],\n\t\tdomain: [0,1],\n\t\tdefaultOut: 0,\n\t\tactivateFunction: 'threshold',\n\t\tlength: 0\n\t}\n\n\taddNeuron(params) {\n\n\t\tthis.neurons.push(new Neuron({\n\t\t\tweights: [],\n\t\t\tdomain: this.params.domain,\n\t\t\tdefaultOut: this.params.defaultOut,\n\t\t\tactivateFunction: this.params.activateFunction,\n\t\t\t...params\n\t\t}));\n\n\t}\n\n\tprocess(signals) {\n\n\t\tthis.out = this.neurons.map(neuron => neuron.process(signals));\n\t\treturn this.out;\n\n\t}\n\n\tget signals() {\n\n\t\treturn this.out;\n\n\t}\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/neuro_net/layer.js","import ACTIVATE_FUNCTIONS from './ready_functions';\n\nexport default class Neuron {\n\n\tconstructor(params) {\n\n\t\tthis.params = {\n\t\t\t...Neuron.defaultParams,\n\t\t\t...params\n\t\t}\n\n\t\tthis.activationFunc = Neuron.GetActivationFunc(this.params.activateFunction);\n\t\tthis.out = this.params.defaultOut;\n\n\t}\n\n\tstatic defaultParams = {\n\t\tweights: [],\n\t\tdomain: [0,1],\n\t\tdefaultOut: 0,\n\t\tactivateFunction: 'threshold'\n\t}\n\n\tstatic GetActivationFunc(func) {\n\n\t\tswitch (typeof func) {\n\n\t\t\tcase 'function':\n\n\t\t\t\treturn func;\n\n\t\t\tcase 'string':\n\n\t\t\t\treturn ACTIVATE_FUNCTIONS[ func ];\n\n\t\t\tdefault:\n\n\t\t\t\tthrow new Error('Neuron\\'s \\'activateFunction\\' param must be a string of function');\n\n\t\t}\n\n\t}\n\n\tprocess(signals) {\n\n\t\tthis.out = this.activationFunc(this.sum(signals));\n\t\treturn this.out;\n\n\t}\n\n\tsum(signals) {\n\n\t\tlet sum = 0;\n\n\t\tfor (let i = 0; i < signals.length; i++) {\n\n\t\t\tconst weight = this.params.weights[ i ];\n\n\t\t\tif (!Number.isFinite(weight) || !Number.isFinite(signals[ i ])) {\n\n\t\t\t\tthrow new Error(`Signal or weight is not finite: weight ${weight}, signal ${signals[ i ]}`);\n\n\t\t\t}\n\n\t\t\tsum += signals[ i ] * weight;\n\n\t\t}\n\n\t\treturn sum;\n\n\t}\n\n\tget signal() {\n\n\t\treturn this.out;\n\n\t}\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/neuro_net/neuron.js","import ACTIVATE_FUNCTIONS from './activate_functions';\n\nconst functions = {};\n\nObject.keys(ACTIVATE_FUNCTIONS).map(key => {\n\n\tlet func = () => {};\n\n\tswitch (key) {\n\n\t\tcase 'threshold':\n\n\t\t\tfunc = ACTIVATE_FUNCTIONS[ key ].bind(null, 0, 1, 0.5);\n\n\t\tcase 'gisterezis':\n\n\t\t\tfunc = ACTIVATE_FUNCTIONS[ key ].bind(null, 0, 1, 0.35, 0.65);\n\n\t\tcase 'sigmoid':\n\n\t\t\tfunc = ACTIVATE_FUNCTIONS[ key ].bind(null, 0, 1, 1);\n\n\n\t}\n\n\tfunctions[ key ] = func;\n\t\n});\n\nexport default functions;\n\n\n// WEBPACK FOOTER //\n// ./src/neuro_net/ready_functions.js","export default {\n\n\t'threshold': (min, max, t, s) => {\n\n\t\treturn s > t ? max : min;\n\n\t},\n\t'gisterezis': (min, max, p1, p2, s) => {\n\n\t\treturn s <= p1\n\t\t\t? min\n\t\t\t: s >= p2\n\t\t\t? max\n\t\t\t: min + ((max - min) * ((s - p1) / (p2 - p1)));\n\n\t},\n\t'sigmoid': (min, max, A, s) => {\n\n\t\treturn 1 / (1 + Math.exp(-A * (s - (max - min) / 2)))\n\n\t}\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/neuro_net/activate_functions.js","// import { Node } from 'quantizer/state';\n// import { isMap } from '../types/types';\n\n/**\n * Creates a new Vec2.\n * @class\n */\n\nclass Vec2 {\n\n\tconstructor(x, y) {\n\n\t\tif ( typeof x === 'object' ) {\n\n\t\t\tthis.set(x);\n\n\t\t} else {\n\n\t\t\tthis.x = x || 0;\n\t\t\tthis.y = y || 0;\n\n\t\t}\n\n\n\n\t}\n\n\tstatic From(obj) {\n\n\t\treturn new Vec2().set(obj);\n\n\t}\n\n\t/**\n\t * Summary two vectors.\n\t *\n\t * @static\n\t * @param { Vec2 } vec1 - first vector\n\t * @param { Vec2 } vec2 - second vector\n\t * @returns { Vec2 }\n\t */\n\n\tstatic Add(vec1, vec2) {\n\n\t\treturn new Vec2(vec1.x + vec2.x, vec1.y + vec2.y);\n\n\t}\n\n\t/**\n\t * Subvector two vectors.\n\t *\n\t * @static\n\t * @param { Vec2 } vec1 - first vector\n\t * @param { Vec2 } vec2 - second vector\n\t * @returns { Vec2 }\n\t */\n\n\tstatic Sub(vec1, vec2) {\n\n\t\treturn new Vec2(vec1.x - vec2.x, vec1.y - vec2.y);\n\n\t}\n\n\t/**\n\t * Multiply two vectors.\n\t *\n\t * @static\n\t * @param { Vec2 } vec1 - first vector\n\t * @param { Vec2 } vec2 - second vector\n\t * @returns { Vec2 }\n\t */\n\n\tstatic Multiply(vec1, vec2) {\n\n\t\treturn new Vec2(vec1.x * vec2.x, vec1.y * vec2.y);\n\n\t}\n\n\t/**\n\t * Divide 2 argument vectors.\n\t *\n\t * @static\n\t * @param { Vec2 } vec1 - first vector\n\t * @param { Vec2 } vec2 - second vector\n\t * @returns { Vec2 }\n\t */\n\n\tstatic Divide(vec1, vec2) {\n\n\t\treturn new Vec2(vec1.x / vec2.x, vec1.y / vec2.y);\n\n\t}\n\n\t/**\n\t * Distance between 2 argument vectors.\n\t *\n\t * @static\n\t * @param { Vec2 } vec1 - first vector\n\t * @param { Vec2 } vec2 - second vector\n\t * @returns { Number }\n\t */\n\n\tstatic Distance(vec1, vec2) {\n\n\t\treturn Math.sqrt(Math.pow(vec1.x - vec2.x, 2) + Math.pow(vec1.y - vec2.y, 2));\n\n\t}\n\n\t/**\n\t * Dot product\n\t *\n\t * @param { Vec2 } vec1 - first vector\n\t * @param { Vec2 } vec2 - second vector\n\t * @returns {number}\n\t */\n\n\tstatic DotProduct(vec1, vec2) {\n\n\t\treturn vec1.x * vec2.x + vec1.y * vec2.y;\n\n\t}\n\n\t/**\n\t * Projecting vector to vector\n\t *\n\t * @param { Vec2 } vec1 - first vector\n\t * @param { Vec2 } vec2 - second vector\n\t * @returns { Vec2 }\n\t */\n\n\tstatic Project(vec1, vec2) {\n\n\t\tconst d = vec2.dotProduct(vec2);\n\n\t\tif (d > 0) {\n\n\t\t\tconst dp = vec1.dotProduct(vec2);\n\t\t\tconst multiplier = dp / d;\n\t\t\treturn vec2.multScalar(multiplier);\n\n\t\t}\n\t\treturn new Vec2(0, 0);\n\n\t}\n\n\t/**\n\t * Get angle between two vectors\n\t *\n\t * @param { Vec2 } vec1 - first vector\n\t * @param { Vec2 } vec2 - second vector\n\t * @returns {number}\n\t */\n\t\n\tstatic Angle(vec1, vec2) {\n\n\t\treturn vec1.dotProduct(vec2) / (vec1.length * vec2.length);\n\t\t\n\t}\n\n\t/**\n\t * Get vector object.\n\t *\n\t * @returns { Object }\n\t */\n\n\tget() {\n\n\t\tlet result = {};\n\n\t\tif (arguments.length) {\n\n\t\t\tfor (let name in arguments[ 0 ]) {\n\n\t\t\t\tresult[ name ] = this[ name ];\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tresult = {\n\t\t\t\tx: this.x,\n\t\t\t\ty: this.y\n\t\t\t};\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tsub(vec2) {\n\n\t\treturn Vec2.Sub(this, vec2);\n\n\t}\n\n\tadd(vec2) {\n\n\t\treturn Vec2.Add(this, vec2);\n\n\t}\n\n\tmult(vec2) {\n\n\t\treturn Vec2.Multiply(this, vec2);\n\n\t}\n\n\t/**\n\t * Set vector object.\n\t *\n\t * @param { Object } source - Source value.\n\t * @returns { Vec2 }\n\t */\n\n\tset() {\n\n\t\tfor (let name in arguments[ 0 ]) {\n\n\t\t\tthis[ name ] = arguments[ 0 ][ name ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetX(value) {\n\n\t\treturn new Vec2(value, this.y);\n\n\t}\n\n\n\tsetY(value) {\n\n\t\treturn new Vec2(this.x, value);\n\n\t}\n\n\t/**\n\t *  Get vector length.\n\t *\n\t *  @returns { Number }\n\t */\n\n\tget length() {\n\n\t\treturn Math.sqrt(this.x * this.x + this.y * this.y);\n\n\t}\n\n\t/**\n\t *  Get modified vector by multiply coords.\n\t *\n\t *  @returns { Vec2 }\n\t */\n\n\tmultScalar(scalar) {\n\n\t\treturn new Vec2(this.x * scalar, this.y * scalar);\n\n\t}\n\n\t/**\n\t *  Get inverted vector.\n\t *\n\t *  @returns { Vec2 }\n\t */\n\n\tinvert() {\n\n\t\treturn new Vec2(-this.x, -this.y);\n\n\t}\n\n\t/**\n\t *  Get vector by x coord.\n\t *\n\t *  @returns { Vec2 }\n\t */\n\n\tinvertX() {\n\n\t\treturn new Vec2(-this.x, this.y);\n\n\t}\n\n\t/**\n\t *  Get vector by y coord.\n\t *\n\t *  @returns { Vec2 }\n\t */\n\n\tinvertY() {\n\n\t\treturn new Vec2(this.x, -this.y);\n\n\t}\n\n\t/**\n\t *  Clone vector.\n\t *\n\t *  @returns { Vec2 }\n\t */\n\n\tclone() {\n\n\t\treturn new Vec2(this.x, this.y);\n\n\t}\n\n\t/**\n\t *  Min vector.\n\t *\n\t * @param { Object } vec - min vector.\n\t *  @returns { Vec2 }\n\t */\n\n\tmin(vec) {\n\n\t\tif (this.x < vec.x) {\n\n\t\t\tthis.x = vec.x;\n\n\t\t}\n\n\t\tif (this.y < vec.y) {\n\n\t\t\tthis.y = vec.y;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t *  Normalize vector.\n\t *\n\t *  @returns { Vec2 }\n\t */\n\n\tnormal() {\n\n\t\treturn new Vec2(Math.abs(this.x), Math.abs(this.y));\n\n\t}\n\n\t/**\n\t *  Max vector.\n\t *\n\t * @param { Object } vec - max vector.\n\t * @returns { Vec2 }\n\t */\n\n\tmax(vec) {\n\n\t\tif (this.x > vec.x) {\n\n\t\t\tthis.x = vec.x;\n\n\t\t}\n\n\t\tif (this.y > vec.y) {\n\n\t\t\tthis.y = vec.y;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tfromSize(size) {\n\n\t\tthis.set({\n\t\t\tx: size.w,\n\t\t\ty: size.h\n\t\t});\n\n\t}\n\n\ttoSize() {\n\n\t\treturn {\n\t\t\tw: this.x,\n\t\t\th: this.y\n\t\t};\n\n\t}\n\n\tdotProduct(vec) {\n\n\t\treturn Vec2.DotProduct(this, vec);\n\n\t}\n\n\tproject(vec) {\n\n\t\treturn Vec2.Project(this, vec);\n\n\t}\n\n\tangle(vec) {\n\n\t\treturn Vec2.Angle(this, vec);\n\n\t}\n\n}\n\nexport default Vec2;\n\n\n\n// WEBPACK FOOTER //\n// ./src/math/vec2.js","class UIController {\n\n\tconstructor() {\n\n\t\tthis.callback = () => {};\n\n\t}\n\n\tinit(obj) {\n\t\t\n\t\tthis.putButtons(\n\t\t\tobj.options.visibleUnit,\n\t\t\tobj.options.populationSize,\n\t\t\tobj.current.map(u => u.unit)\n\t\t);\n\t\tthis.putPlayPause();\n\n\t}\n\n\tsetCallback(func) {\n\n\t\tthis.callback = func;\n\n\t}\n\n\tsetStyle(node, style) {\n\n\t\tfor (let i in style) {\n\n\t\t\tnode.style[ i ] = style[ i ];\n\n\t\t}\n\n\t}\n\t\n\tupdate(obj, visible, highlight) {\n\n\t\tconst cont = document.querySelector('#buttons_cont');\n\t\tif (cont) {\n\t\t\tobj.map((o, key) => {\n\t\t\t\tconst c = cont.children[key];\n\t\t\t\tconst life = Math.max(Math.min(o.life, 100), 0);\n\t\t\t\tconst btn = c.children[ 0 ];\n\t\t\t\tconst graph = c.children[ 1 ];\n\t\t\t\tconst color = `rgb(${\n\t\t\t\t\tMath.round(255 - (life / 100 * 255))\n\t\t\t\t\t}, ${Math.round(life / 100 * 255)}, 0)`;\n\t\t\t\tbtn.style.color = visible === key + 1 ? 'green' : 'black';\n\t\t\t\tbtn.style.fontWeight = visible === key + 1 ? 'bold' : 'normal';\n\t\t\t\tbtn.style.backgroundColor = highlight === key ? 'lightblue' : 'transparent';\n\t\t\t\tgraph.style.height = `${life / 2}px`;\n\t\t\t\tgraph.style.backgroundColor = color;\n\t\t\t\tgraph.innerHTML = o.score;\n\t\t\t});\n\t\t}\n\t\t\n\t}\n\n\tcreateElement(i, selected) {\n\n\t\tconst style = {\n\t\t\tborder: '1px solid black',\n\t\t\tfontSize: '16px',\n\t\t\twidth: '30px',\n\t\t\theight: '30px',\n\t\t\tcolor: 'black',\n\t\t\tlineHeight: '30px',\n\t\t\tcursor: 'pointer',\n\t\t\tfontWeight: 'normal'\n\t\t};\n\n\t\tconst selStyle = {\n\t\t\tcolor: 'green',\n\t\t\tfontWeight: 'bold'\n\t\t}\n\n\t\tconst cont = document.createElement('div');\n\t\tcont.id = i;\n\t\tthis.setStyle(cont, {\n\t\t\tdisplay: 'inline-block',\n\t\t\tmarginLeft: '-1px',\n\t\t});\n\t\tconst el = document.createElement('div');\n\t\tthis.setStyle(el, Object.assign({}, style, selected === i ? selStyle : {}));\n\t\tel.innerText = i;\n\t\tel.onclick = () => {\n\t\t\tthis.callback('options', { visibleUnit: i });\n\t\t};\n\n\t\tcont.appendChild(el);\n\n\t\tconst score = document.createElement('div');\n\t\tscore.innerHTML = 0;\n\t\tthis.setStyle(score, {\n\t\t\theight: `50px`,\n\t\t\twidth: '100%',\n\t\t\tbackgroundColor: `green`\n\t\t});\n\n\t\tcont.appendChild(score);\n\n\t\treturn cont;\n\n\t}\n\n\tputButtons(selected, num) {\n\n\t\tconst cont = document.createElement('div');\n\t\tcont.id = 'buttons_cont';\n\t\tdocument.body.appendChild(cont);\n\n\t\tthis.setStyle(cont, { textAlign: 'center' });\n\n\t\tconst arr = new Array(num)\n\t\t\t.fill(null)\n\t\t\t.map((a, key) => key + 1);\n\t\tarr.push('HS');\n\t\tarr.map((i) => {\n\n\t\t\tconst el = this.createElement(i, selected);\n\t\t\tcont.appendChild(el);\n\n\t\t});\n\n\t}\n\n\tputPlayPause() {\n\n\t\tconst btn = document.createElement('div');\n\t\tbtn.id = 'play';\n\t\tbtn.innerHTML = 'Play/Pause';\n\t\tthis.setStyle(btn, {\n\t\t\twidth: '100px',\n\t\t\tmargin: '20px auto',\n\t\t\tcursor: 'pointer'\n\t\t});\n\t\tbtn.onclick = () => {\n\t\t\tthis.callback('play');\n\t\t}\n\n\t\tdocument.body.appendChild(btn);\n\n\t}\n\n}\n\nexport default new UIController();\n\n\n// WEBPACK FOOTER //\n// ./src/ui_controller.js"],"sourceRoot":""}