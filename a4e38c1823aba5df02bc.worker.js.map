{"version":3,"sources":["webpack:///webpack/bootstrap a4e38c1823aba5df02bc","webpack:///./src/workers/simulator_worker.js","webpack:///./src/simulator/index.js","webpack:///./src/neuro_net/network.js","webpack:///./src/neuro_net/layer.js","webpack:///./src/neuro_net/neuron.js","webpack:///./src/neuro_net/ready_functions.js","webpack:///./src/neuro_net/activate_functions.js","webpack:///./src/math/vec2.js","webpack:///./src/constants/world.js"],"names":["SimulatorWorker","simulator","self","addEventListener","onMessage","delay","population","food","init","clearInterval","interval","setInterval","step","res","end","pause","postMessage","type","unit","err","console","warn","message","e","data","state","start","NETWORK_PARAMS","weights","layers","length","activateFunction","Simulator","rooms","units","foods","map","u","score","mind","life","fine","prevMovement","source","key","main_vector","sub","point","circlePoint","project","_vec","add","radius","vec_length","begintInter","endInter","isInterruct","DotProduct","interSect","projectedPoint","ort","multScalar","l","Math","sqrt","p1","p2","filtered","filter","p","x","y","sort","a","b","_a","Sub","_b","endPoints","concat","findCollisions","min","active","from","to","full","PI","part","curDeg","i","vec","cos","sin","push","processLine","lines","round","line","movement","coords","max","checkMovement","diff","abs","_key","splice","room","getUnitLines","signals","getUnitSignals","process","movedUnit","moveUnit","checkEat","Network","params","defaultParams","input","_in","ACTIVATE_FUNCTIONS","Layer","neurons","Array","fill","n","domain","defaultOut","out","neuron","Neuron","activationFunc","GetActivationFunc","sum","weight","Number","isFinite","Error","func","functions","Object","keys","bind","t","s","A","exp","Vec2","set","result","arguments","name","vec2","Add","Multiply","value","scalar","size","w","h","Project","Angle","obj","vec1","pow","d","dotProduct","dp","multiplier","PARTS_NUM","UNIT_RAD","FOOD_RAD","LINE_LENGTH"],"mappings":"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","file":"a4e38c1823aba5df02bc.worker.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap a4e38c1823aba5df02bc","import Simulator from '../simulator';\n\nclass SimulatorWorker {\n\n\tconstructor() {\n\n\t\tthis.simulator = new Simulator();\n\t\tself.addEventListener('message', ::this.onMessage);\n\t\tthis.delay = 10;\n\n\t}\n\n\tinit(population, food) {\n\n\t\tthis.simulator.init(population, food);\n\n\t}\n\n\tstart() {\n\n\t\tclearInterval(this.interval);\n\t\tthis.interval = setInterval(() => {\n\t\t\tthis.step();\n\t\t}, this.delay);\n\n\t}\n\n\tpause() {\n\n\t\tclearInterval(this.interval);\n\n\t}\n\n\tstep() {\n\n\t\ttry {\n\n\t\t\tconst res = this.simulator.step()[ 0 ];\n\t\t\tif (res.end) {\n\n\t\t\t\tthis.pause();\n\n\t\t\t}\n\n\t\t\tpostMessage({ type: 'STEP_SUCCESS', unit: res });\n\n\t\t} catch (err) {\n\n\t\t\tthis.pause();\n\t\t\tconsole.warn(err);\n\t\t\tpostMessage({ type: 'STEP_ERROR', err: err.message });\n\n\t\t}\n\n\t}\n\n\tonMessage(e) {\n\n\t\tconst { type, population, food, delay, state } = e.data;\n\n\t\tswitch (type) {\n\n\t\t\tcase 'INIT':\n\n\t\t\t\tthis.init(population, food);\n\t\t\t\tif (typeof delay !== 'undefined') {\n\t\t\t\t\tthis.delay = delay;\n\t\t\t\t}\n\t\t\t\tthis.start();\n\t\t\t\tbreak;\n\n\t\t\tcase 'CHANGE_DELAY':\n\n\t\t\t\tthis.delay = delay;\n\t\t\t\tthis.pause();\n\t\t\t\tthis.start();\n\t\t\t\tbreak;\n\n\t\t\tcase 'CHANGE_STATE':\n\n\t\t\t\tif (state === 'paused') {\n\t\t\t\t\tthis.pause();\n\t\t\t\t} else {\n\t\t\t\t\tthis.start();\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\treturn false;\n\n\t\t}\n\t\treturn true;\n\t}\n\n\n}\n\nexport default new SimulatorWorker();\n\n\n// WEBPACK FOOTER //\n// ./src/workers/simulator_worker.js","import Net from '../neuro_net/network';\nimport Vec2 from '../math/vec2';\nimport { PARTS_NUM, UNIT_RAD, FOOD_RAD, LINE_LENGTH } from '../constants/world';\n\nconst NETWORK_PARAMS = (weights) => {\n\treturn {\n\t\tlayers: [\n\t\t\t{\n\t\t\t\tweights: weights[ 0 ],\n\t\t\t\tlength: weights[ 0 ].length,\n\t\t\t\tactivateFunction: 'sigmoid'\n\t\t\t},\n\t\t\t{\n\t\t\t\tweights: weights[ 1 ],\n\t\t\t\tlength: weights[ 1 ].length,\n\t\t\t\tactivateFunction: 'sigmoid'\n\t\t\t}\n\t\t]\n\t}\n}\n\nexport default class Simulator {\n\n\tconstructor() {\n\n\t\tthis.rooms = [{\n\t\t\tunits: [],\n\t\t\tfoods: []\n\t\t}];\n\n\t}\n\n\tinit(units, foods) {\n\t\t\n\t\tthis.rooms = units.map(u => {\n\t\t\treturn {\n\t\t\t\tunit: {\n\t\t\t\t\t...u,\n\t\t\t\t\tscore: 0,\n\t\t\t\t\tmind: new Net(NETWORK_PARAMS(u.weights)),\n\t\t\t\t\tlife: 100,\n\t\t\t\t\tfine: 0,\n\t\t\t\t\tprevMovement: new Vec2(0, 0)\n\t\t\t\t},\n\t\t\t\tfoods: foods.map(food => new Vec2(food))\n\t\t\t}\n\t\t});\n\n\t}\n\n\tfindCollisions(source, end, key) {\n\n\t\treturn this.rooms[ key ].foods.map(circlePoint => {\n\n\t\t\tconst main_vector = end.sub(source);\n\n\t\t\tconst point = circlePoint.sub(source).project(main_vector);\n\t\t\tconst _vec = point.add(source).sub(circlePoint);\n\n\t\t\tconst radius = FOOD_RAD;\n\t\t\tconst vec_length = _vec.length;\n\t\t\tconst begintInter = source.sub(circlePoint).length < radius;\n\t\t\tconst endInter = end.sub(circlePoint).length < radius;\n\n\t\t\tconst isInterruct = vec_length < radius\n\t\t\t\t&& Vec2.DotProduct(point, main_vector) >= 0\n\t\t\t\t&& main_vector.length >= point.length;\n\t\t\tconst interSect = isInterruct || (begintInter || endInter);\n\n\t\t\tif (interSect) {\n\n\t\t\t\tconst projectedPoint = point.add(source);\n\t\t\t\tconst ort = main_vector.multScalar(1/main_vector.length);\n\t\t\t\tconst l = Math.sqrt(radius*radius - vec_length*vec_length) * 2;\n\n\t\t\t\tconst p1 = projectedPoint.sub(ort.multScalar((l / 2)));\n\t\t\t\tconst p2 = projectedPoint.add(ort.multScalar((l / 2)));\n\n\t\t\t\tconst filtered = [p1, p2].filter(p => {\n\t\t\t\t\treturn ((p.x >= source.x && p.x <= end.x) || (p.x <= source.x && p.x >= end.x))\n\t\t\t\t\t\t&& ((p.y >= source.y && p.y <= end.y) || (p.y <= source.y && p.y >= end.y))\n\t\t\t\t}).sort((a, b) => {\n\n\t\t\t\t\tconst _a = Vec2.Sub(a, source).length;\n\t\t\t\t\tconst _b = Vec2.Sub(b, source).length;\n\n\t\t\t\t\tif (_a > _b) {\n\t\t\t\t\t\treturn 1;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (_a > _b) {\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn 0;\n\n\t\t\t\t})[0];\n\n\t\t\t\tif (filtered) {\n\n\t\t\t\t\treturn filtered;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn false;\n\n\t\t});\n\n\t}\n\n\tprocessLine(start, end, key) {\n\n\t\tconst endPoints = [end].concat(this.findCollisions(start, end, key));\n\t\tlet min = end.sub(start).length;\n\t\tlet res = end;\n\t\tlet active = false;\n\t\tendPoints.map(p => {\n\n\t\t\tif (p) {\n\t\t\t\tconst length = p.sub(start).length;\n\t\t\t\tif (length < min) {\n\t\t\t\t\tactive = true;\n\t\t\t\t\tmin = length;\n\t\t\t\t\tres = p;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn p;\n\n\t\t});\n\t\treturn {\n\t\t\tfrom: start,\n\t\t\tto: res,\n\t\t\tactive\n\t\t};\n\n\t}\n\n\tgetUnitLines(unit, key) {\n\n\t\tconst full = Math.PI * 2;\n\t\tconst part = full / PARTS_NUM;\n\t\tlet curDeg = -part;\n\t\tlet res = [];\n\n\t\tfor (let i = 0; i < PARTS_NUM; i++) {\n\n\t\t\tcurDeg += part;\n\t\t\tconst vec = new Vec2(\n\t\t\t\tMath.cos(curDeg),\n\t\t\t\tMath.sin(curDeg),\n\t\t\t);\n\n\t\t\tres.push(this.processLine(\n\t\t\t\tnew Vec2(unit).add(vec.multScalar(UNIT_RAD)),\n\t\t\t\tnew Vec2(unit).add(vec.multScalar(UNIT_RAD))\n\t\t\t\t\t.add(vec.multScalar(LINE_LENGTH)),\n\t\t\t\tkey\n\t\t\t));\n\n\t\t}\n\n\t\treturn res;\n\n\t}\n\n\tgetUnitSignals(lines) {\n\n\t\treturn lines.map(line =>\n\t\t(\n\t\t\tMath.round(\n\t\t\t\t(LINE_LENGTH - Math.min(line.to.sub(line.from).length, 25)) * 1000\n\t\t\t) / 1000) / LINE_LENGTH\n\t\t);\n\n\t}\n\n\tmoveUnit(movement, key) {\n\n\t\tconst full = Math.PI * 2;\n\t\tconst part = full / PARTS_NUM;\n\t\tlet curDeg = -part;\n\t\tlet x = 0;\n\t\tlet y = 0;\n\n\t\tfor (let i = 0; i < PARTS_NUM; i++) {\n\n\t\t\tcurDeg += part;\n\t\t\tx += movement[ i ] * Math.cos(curDeg) * 2;\n\t\t\ty += movement[ i ] * Math.sin(curDeg) * 2;\n\n\t\t}\n\n\t\tconst coords = new Vec2(\n\t\t\tthis.rooms[ key ].unit.x + x,\n\t\t\tthis.rooms[ key ].unit.y + y\n\t\t)\n\t\t\t.max(new Vec2(800 - UNIT_RAD, 400 - UNIT_RAD))\n\t\t\t.min(new Vec2(0 + UNIT_RAD, 0 + UNIT_RAD));\n\n\t\tthis.rooms[ key ].unit = this.checkMovement(this.rooms[ key ].unit, x, y, coords);\n\n\t\tthis.rooms[ key ].unit.prevMovement = new Vec2(x, y);\n\t\tthis.rooms[ key ].unit.x = coords.x;\n\t\tthis.rooms[ key ].unit.y = coords.y;\n\n\t\treturn this.rooms[ key ].unit;\n\n\t}\n\n\tcheckMovement(unit, x, y, coords) {\n\t\tconst diff = Math.abs(unit.x - coords.x)\n\t\t\t+ Math.abs(unit.y - coords.y);\n\n\t\tif (new Vec2(x, y).add(unit.prevMovement).length <= 0.05) {\n\t\t\tunit.fine += 1;\n\t\t} else {\n\t\t\tif (diff < 0.1 && diff > 0.001) {\n\t\t\t\tunit.life -= 0.5 - diff;\n\t\t\t}\n\t\t\tif (diff < 0.001) {\n\t\t\t\tif (unit.fine === 50) {\n\t\t\t\t\tunit.life = 0;\n\t\t\t\t} else {\n\t\t\t\t\tunit.fine += 1;\n\t\t\t\t\tunit.life -= 1;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tunit.fine = 0;\n\t\t\t}\n\t\t}\n\n\t\treturn unit;\n\t}\n\n\tcheckEat(unit, key) {\n\n\t\tthis.rooms[ key ].foods.map((food, _key) => {\n\t\t\t\n\t\t\tif (Vec2.Sub(food, unit).length < UNIT_RAD + FOOD_RAD ) {\n\t\t\t\t\n\t\t\t\tthis.rooms[ key ].foods.splice(_key, 1);\n\t\t\t\tthis.rooms[ key ].unit.score += 1;\n\t\t\t\tthis.rooms[ key ].unit.life += 40;\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t});\n\n\t\treturn this.rooms[ key ].unit.score;\n\n\t}\n\n\tstep() {\n\n\t\treturn this.rooms.map((room, key) => {\n\n\t\t\tlet lines = this.getUnitLines(room.unit, key);\n\t\t\tlet score = this.rooms[ key ].unit.score;\n\t\t\tif (room.unit.life > 0) {\n\t\t\t\tconst signals = this.getUnitSignals(lines);\n\t\t\t\tconst movement = room.unit.mind.process(signals);\n\t\t\t\tconst movedUnit = this.moveUnit(movement, key);\n\t\t\t\tscore = this.checkEat(movedUnit, key);\n\t\t\t\tthis.rooms[ key ].unit.life += -0.1;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tunits: [{\n\t\t\t\t\tx: this.rooms[ key ].unit.x,\n\t\t\t\t\ty: this.rooms[ key ].unit.y,\n\t\t\t\t\tradius: UNIT_RAD,\n\t\t\t\t\tlines,\n\t\t\t\t\tscore,\n\t\t\t\t\tlife: this.rooms[ key ].unit.life\n\t\t\t\t}],\n\t\t\t\tfood: this.rooms[ key ].foods,\n\t\t\t\tend: this.rooms[ key ].unit.life <= 0\n\t\t\t}\n\n\t\t});\n\n\t}\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/simulator/index.js","import Layer from './layer';\nimport ACTIVATE_FUNCTIONS from './activate_functions';\n\nexport default class Network {\n\n\tconstructor(params) {\n\n\t\tthis.params = {\n\t\t\t...Network.defaultParams,\n\t\t\t...params\n\t\t}\n\n\t\tthis.layers = this.params.layers.map(p => new Layer(p));\n\n\t}\n\n\tstatic defaultParams = {\n\t\tlayers: []\n\t};\n\t\n\tstatic ACTIVATE_FUNCTIONS = ACTIVATE_FUNCTIONS;\n\n\taddLayer(params) {\n\n\t\tthis.layers.push(new Layer(params));\n\n\t}\n\n\tprocess(input) {\n\n\t\tif (!this.layers.length) {\n\n\t\t\t// return Promise.resolve(null);\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// return new Promise((resolve, reject) => {\n\n\t\t\tfor (let i = 0; i < this.layers.length; i++) {\n\n\t\t\t\tconst _in = i == 0 ? input : this.layers[ i - 1 ].signals;\n\t\t\t\tthis.layers[ i ].process(_in);\n\n\t\t\t}\n\n\t\t\treturn this.layers[ this.layers.length - 1 ].signals;\n\n\t\t// });\n\n\t}\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/neuro_net/network.js","import Neuron from './neuron';\n\nexport default class Layer {\n\n\tconstructor(params) {\n\n\t\tthis.params = {\n\t\t\t...Layer.defaultParams,\n\t\t\t...params\n\t\t}\n\n\t\tthis.neurons = new Array(this.params.length)\n\t\t\t.fill(null)\n\t\t\t.map((n, key) => new Neuron({\n\t\t\t\tweights: this.params.weights[ key ] || [],\n\t\t\t\tdomain: this.params.domain,\n\t\t\t\tdefaultOut: this.params.defaultOut,\n\t\t\t\tactivateFunction: this.params.activateFunction,\n\t\t\t}));\n\n\t\tthis.out = this.params.defaultOut;\n\n\t}\n\n\tstatic defaultParams = {\n\t\tweights: [],\n\t\tdomain: [0,1],\n\t\tdefaultOut: 0,\n\t\tactivateFunction: 'threshold',\n\t\tlength: 0\n\t}\n\n\taddNeuron(params) {\n\n\t\tthis.neurons.push(new Neuron({\n\t\t\tweights: [],\n\t\t\tdomain: this.params.domain,\n\t\t\tdefaultOut: this.params.defaultOut,\n\t\t\tactivateFunction: this.params.activateFunction,\n\t\t\t...params\n\t\t}));\n\n\t}\n\n\tprocess(signals) {\n\n\t\tthis.out = this.neurons.map(neuron => neuron.process(signals));\n\t\treturn this.out;\n\n\t}\n\n\tget signals() {\n\n\t\treturn this.out;\n\n\t}\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/neuro_net/layer.js","import ACTIVATE_FUNCTIONS from './ready_functions';\n\nexport default class Neuron {\n\n\tconstructor(params) {\n\n\t\tthis.params = {\n\t\t\t...Neuron.defaultParams,\n\t\t\t...params\n\t\t}\n\n\t\tthis.activationFunc = Neuron.GetActivationFunc(this.params.activateFunction);\n\t\tthis.out = this.params.defaultOut;\n\n\t}\n\n\tstatic defaultParams = {\n\t\tweights: [],\n\t\tdomain: [0,1],\n\t\tdefaultOut: 0,\n\t\tactivateFunction: 'threshold'\n\t}\n\n\tstatic GetActivationFunc(func) {\n\n\t\tswitch (typeof func) {\n\n\t\t\tcase 'function':\n\n\t\t\t\treturn func;\n\n\t\t\tcase 'string':\n\n\t\t\t\treturn ACTIVATE_FUNCTIONS[ func ];\n\n\t\t\tdefault:\n\n\t\t\t\tthrow new Error('Neuron\\'s \\'activateFunction\\' param must be a string of function');\n\n\t\t}\n\n\t}\n\n\tprocess(signals) {\n\n\t\tthis.out = this.activationFunc(this.sum(signals));\n\t\treturn this.out;\n\n\t}\n\n\tsum(signals) {\n\n\t\tlet sum = 0;\n\n\t\tfor (let i = 0; i < signals.length; i++) {\n\n\t\t\tconst weight = this.params.weights[ i ];\n\n\t\t\tif (!Number.isFinite(weight) || !Number.isFinite(signals[ i ])) {\n\n\t\t\t\tthrow new Error(`Signal or weight is not finite: weight ${weight}, signal ${signals[ i ]}`);\n\n\t\t\t}\n\n\t\t\tsum += signals[ i ] * weight;\n\n\t\t}\n\n\t\treturn sum;\n\n\t}\n\n\tget signal() {\n\n\t\treturn this.out;\n\n\t}\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/neuro_net/neuron.js","import ACTIVATE_FUNCTIONS from './activate_functions';\n\nconst functions = {};\n\nObject.keys(ACTIVATE_FUNCTIONS).map(key => {\n\n\tlet func = () => {};\n\n\tswitch (key) {\n\n\t\tcase 'threshold':\n\n\t\t\tfunc = ACTIVATE_FUNCTIONS[ key ].bind(null, 0, 1, 0.5);\n\n\t\tcase 'gisterezis':\n\n\t\t\tfunc = ACTIVATE_FUNCTIONS[ key ].bind(null, 0, 1, 0.35, 0.65);\n\n\t\tcase 'sigmoid':\n\n\t\t\tfunc = ACTIVATE_FUNCTIONS[ key ].bind(null, 0, 1, 1);\n\n\n\t}\n\n\tfunctions[ key ] = func;\n\t\n});\n\nexport default functions;\n\n\n// WEBPACK FOOTER //\n// ./src/neuro_net/ready_functions.js","export default {\n\n\t'threshold': (min, max, t, s) => {\n\n\t\treturn s > t ? max : min;\n\n\t},\n\t'gisterezis': (min, max, p1, p2, s) => {\n\n\t\treturn s <= p1\n\t\t\t? min\n\t\t\t: s >= p2\n\t\t\t? max\n\t\t\t: min + ((max - min) * ((s - p1) / (p2 - p1)));\n\n\t},\n\t'sigmoid': (min, max, A, s) => {\n\n\t\treturn 1 / (1 + Math.exp(-A * (s - (max - min) / 2)))\n\n\t}\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/neuro_net/activate_functions.js","// import { Node } from 'quantizer/state';\n// import { isMap } from '../types/types';\n\n/**\n * Creates a new Vec2.\n * @class\n */\n\nclass Vec2 {\n\n\tconstructor(x, y) {\n\n\t\tif ( typeof x === 'object' ) {\n\n\t\t\tthis.set(x);\n\n\t\t} else {\n\n\t\t\tthis.x = x || 0;\n\t\t\tthis.y = y || 0;\n\n\t\t}\n\n\n\n\t}\n\n\tstatic From(obj) {\n\n\t\treturn new Vec2().set(obj);\n\n\t}\n\n\t/**\n\t * Summary two vectors.\n\t *\n\t * @static\n\t * @param { Vec2 } vec1 - first vector\n\t * @param { Vec2 } vec2 - second vector\n\t * @returns { Vec2 }\n\t */\n\n\tstatic Add(vec1, vec2) {\n\n\t\treturn new Vec2(vec1.x + vec2.x, vec1.y + vec2.y);\n\n\t}\n\n\t/**\n\t * Subvector two vectors.\n\t *\n\t * @static\n\t * @param { Vec2 } vec1 - first vector\n\t * @param { Vec2 } vec2 - second vector\n\t * @returns { Vec2 }\n\t */\n\n\tstatic Sub(vec1, vec2) {\n\n\t\treturn new Vec2(vec1.x - vec2.x, vec1.y - vec2.y);\n\n\t}\n\n\t/**\n\t * Multiply two vectors.\n\t *\n\t * @static\n\t * @param { Vec2 } vec1 - first vector\n\t * @param { Vec2 } vec2 - second vector\n\t * @returns { Vec2 }\n\t */\n\n\tstatic Multiply(vec1, vec2) {\n\n\t\treturn new Vec2(vec1.x * vec2.x, vec1.y * vec2.y);\n\n\t}\n\n\t/**\n\t * Divide 2 argument vectors.\n\t *\n\t * @static\n\t * @param { Vec2 } vec1 - first vector\n\t * @param { Vec2 } vec2 - second vector\n\t * @returns { Vec2 }\n\t */\n\n\tstatic Divide(vec1, vec2) {\n\n\t\treturn new Vec2(vec1.x / vec2.x, vec1.y / vec2.y);\n\n\t}\n\n\t/**\n\t * Distance between 2 argument vectors.\n\t *\n\t * @static\n\t * @param { Vec2 } vec1 - first vector\n\t * @param { Vec2 } vec2 - second vector\n\t * @returns { Number }\n\t */\n\n\tstatic Distance(vec1, vec2) {\n\n\t\treturn Math.sqrt(Math.pow(vec1.x - vec2.x, 2) + Math.pow(vec1.y - vec2.y, 2));\n\n\t}\n\n\t/**\n\t * Dot product\n\t *\n\t * @param { Vec2 } vec1 - first vector\n\t * @param { Vec2 } vec2 - second vector\n\t * @returns {number}\n\t */\n\n\tstatic DotProduct(vec1, vec2) {\n\n\t\treturn vec1.x * vec2.x + vec1.y * vec2.y;\n\n\t}\n\n\t/**\n\t * Projecting vector to vector\n\t *\n\t * @param { Vec2 } vec1 - first vector\n\t * @param { Vec2 } vec2 - second vector\n\t * @returns { Vec2 }\n\t */\n\n\tstatic Project(vec1, vec2) {\n\n\t\tconst d = vec2.dotProduct(vec2);\n\n\t\tif (d > 0) {\n\n\t\t\tconst dp = vec1.dotProduct(vec2);\n\t\t\tconst multiplier = dp / d;\n\t\t\treturn vec2.multScalar(multiplier);\n\n\t\t}\n\t\treturn new Vec2(0, 0);\n\n\t}\n\n\t/**\n\t * Get angle between two vectors\n\t *\n\t * @param { Vec2 } vec1 - first vector\n\t * @param { Vec2 } vec2 - second vector\n\t * @returns {number}\n\t */\n\t\n\tstatic Angle(vec1, vec2) {\n\n\t\treturn vec1.dotProduct(vec2) / (vec1.length * vec2.length);\n\t\t\n\t}\n\n\t/**\n\t * Get vector object.\n\t *\n\t * @returns { Object }\n\t */\n\n\tget() {\n\n\t\tlet result = {};\n\n\t\tif (arguments.length) {\n\n\t\t\tfor (let name in arguments[ 0 ]) {\n\n\t\t\t\tresult[ name ] = this[ name ];\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tresult = {\n\t\t\t\tx: this.x,\n\t\t\t\ty: this.y\n\t\t\t};\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tsub(vec2) {\n\n\t\treturn Vec2.Sub(this, vec2);\n\n\t}\n\n\tadd(vec2) {\n\n\t\treturn Vec2.Add(this, vec2);\n\n\t}\n\n\tmult(vec2) {\n\n\t\treturn Vec2.Multiply(this, vec2);\n\n\t}\n\n\t/**\n\t * Set vector object.\n\t *\n\t * @param { Object } source - Source value.\n\t * @returns { Vec2 }\n\t */\n\n\tset() {\n\n\t\tfor (let name in arguments[ 0 ]) {\n\n\t\t\tthis[ name ] = arguments[ 0 ][ name ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetX(value) {\n\n\t\treturn new Vec2(value, this.y);\n\n\t}\n\n\n\tsetY(value) {\n\n\t\treturn new Vec2(this.x, value);\n\n\t}\n\n\t/**\n\t *  Get vector length.\n\t *\n\t *  @returns { Number }\n\t */\n\n\tget length() {\n\n\t\treturn Math.sqrt(this.x * this.x + this.y * this.y);\n\n\t}\n\n\t/**\n\t *  Get modified vector by multiply coords.\n\t *\n\t *  @returns { Vec2 }\n\t */\n\n\tmultScalar(scalar) {\n\n\t\treturn new Vec2(this.x * scalar, this.y * scalar);\n\n\t}\n\n\t/**\n\t *  Get inverted vector.\n\t *\n\t *  @returns { Vec2 }\n\t */\n\n\tinvert() {\n\n\t\treturn new Vec2(-this.x, -this.y);\n\n\t}\n\n\t/**\n\t *  Get vector by x coord.\n\t *\n\t *  @returns { Vec2 }\n\t */\n\n\tinvertX() {\n\n\t\treturn new Vec2(-this.x, this.y);\n\n\t}\n\n\t/**\n\t *  Get vector by y coord.\n\t *\n\t *  @returns { Vec2 }\n\t */\n\n\tinvertY() {\n\n\t\treturn new Vec2(this.x, -this.y);\n\n\t}\n\n\t/**\n\t *  Clone vector.\n\t *\n\t *  @returns { Vec2 }\n\t */\n\n\tclone() {\n\n\t\treturn new Vec2(this.x, this.y);\n\n\t}\n\n\t/**\n\t *  Min vector.\n\t *\n\t * @param { Object } vec - min vector.\n\t *  @returns { Vec2 }\n\t */\n\n\tmin(vec) {\n\n\t\tif (this.x < vec.x) {\n\n\t\t\tthis.x = vec.x;\n\n\t\t}\n\n\t\tif (this.y < vec.y) {\n\n\t\t\tthis.y = vec.y;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t *  Normalize vector.\n\t *\n\t *  @returns { Vec2 }\n\t */\n\n\tnormal() {\n\n\t\treturn new Vec2(Math.abs(this.x), Math.abs(this.y));\n\n\t}\n\n\t/**\n\t *  Max vector.\n\t *\n\t * @param { Object } vec - max vector.\n\t * @returns { Vec2 }\n\t */\n\n\tmax(vec) {\n\n\t\tif (this.x > vec.x) {\n\n\t\t\tthis.x = vec.x;\n\n\t\t}\n\n\t\tif (this.y > vec.y) {\n\n\t\t\tthis.y = vec.y;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tfromSize(size) {\n\n\t\tthis.set({\n\t\t\tx: size.w,\n\t\t\ty: size.h\n\t\t});\n\n\t}\n\n\ttoSize() {\n\n\t\treturn {\n\t\t\tw: this.x,\n\t\t\th: this.y\n\t\t};\n\n\t}\n\n\tdotProduct(vec) {\n\n\t\treturn Vec2.DotProduct(this, vec);\n\n\t}\n\n\tproject(vec) {\n\n\t\treturn Vec2.Project(this, vec);\n\n\t}\n\n\tangle(vec) {\n\n\t\treturn Vec2.Angle(this, vec);\n\n\t}\n\n}\n\nexport default Vec2;\n\n\n\n// WEBPACK FOOTER //\n// ./src/math/vec2.js","export const PARTS_NUM = 15;\nexport const UNIT_RAD = 30;\nexport const FOOD_RAD = 8;\nexport const LINE_LENGTH = 25;\n\n\n\n// WEBPACK FOOTER //\n// ./src/constants/world.js"],"sourceRoot":""}